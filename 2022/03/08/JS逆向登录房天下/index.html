<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="Hexo Theme Keep">
    <meta name="author" content="Lhj">
    
    <title>
        
            JS逆向登录房天下 |
        
        Alexander
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="/images/logo.svg">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/css/font-awesome.min.css">
    <script id="hexo-configurations">
    let KEEP = window.KEEP || {};
    KEEP.hexo_config = {"hostname":"example.com","root":"/","language":"en","path":"search.json"};
    KEEP.theme_config = {"toc":{"enable":true,"number":true,"expand_all":true,"init_open":true},"style":{"primary_color":"#0066CC","avatar":"/images/avatar.svg","favicon":"/images/logo.svg","article_img_align":"left","left_side_width":"260px","content_max_width":"920px","hover":{"shadow":false,"scale":false},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":"Keep writing and Keep loving."},"scroll":{"progress_bar":{"enable":true},"percent":{"enable":true}}},"local_search":{"enable":true,"preload":false},"code_copy":{"enable":true,"style":"default"},"pjax":{"enable":true},"lazyload":{"enable":true},"version":"3.4.5"};
    KEEP.language_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
  </script>
<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
</head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
        <span class="pjax-progress-bar"></span>
        <span class="pjax-progress-icon">
            <i class="fas fa-circle-notch fa-spin"></i>
        </span>
    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
            <a class="logo-title" href="/">
                Alexander
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                NOTE
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                ARCHIVES
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/about"
                            >
                                ABOUT
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">NOTE</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">ARCHIVES</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/about">ABOUT</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="article-content-container">

        <div class="article-title">
            <span class="title-hover-animation">JS逆向登录房天下</span>
        </div>

        
            <div class="article-header">
                <div class="avatar">
                    <img src="/images/avatar.svg">
                </div>
                <div class="info">
                    <div class="author">
                        <span class="name">Lhj</span>
                        
                            <span class="author-label">Lv6</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fas fa-edit"></i>&nbsp;
        <span class="pc">2022-03-08 17:18:30</span>
        <span class="mobile">2022-03-08 17:18</span>
    </span>
    
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fas fa-file-word"></i>&nbsp;<span>6k Words</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fas fa-clock"></i>&nbsp;<span>36 Mins</span>
        </span>
    
    
        <span class="article-pv article-meta-item">
            <i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                    </div>
                </div>
            </div>
        

        <div class="article-content markdown-body">
            <p>目标网站: <a class="link"   target="_blank" rel="noopener" href="https://www1.fang.com/" >https://www1.fang.com/<i class="fas fa-external-link-alt"></i></a></p>
<h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p>我们打开目标网站，然后点击右上角的登录，选择账号密码登录并且取消自动登录，在登录之前我们先打开控制台，观察参数的加密:</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/bgU6r6"><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://s1.ax1x.com/2022/03/08/bgU6r6.png"
                      alt="bgU6r6.png"
                ></a></p>
<p>这里我随便输入了一对账号密码，然后我们会看到如下加密参数:</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/bgUTMt"><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://s1.ax1x.com/2022/03/08/bgUTMt.png"
                      alt="bgUTMt.png"
                ></a></p>
<p>我们在控制台中搜索pwd，然后惊喜地发现有直接线索:</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/bgaCLV"><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://s1.ax1x.com/2022/03/08/bgaCLV.png"
                      alt="bgaCLV.png"
                ></a></p>
<p>上图红框中有些字眼直接就和加密扯上了关系，我们点进去看看，然后在对应行打下断点，再点击登录，如下图所示:</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/bgazkD"><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://s1.ax1x.com/2022/03/08/bgazkD.png"
                      alt="bgazkD.png"
                ></a></p>
<p>上图红框中的函数有两个参数，我们分别复制到console中看看是什么值，如下图所示:</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/bgdQcn"><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://s1.ax1x.com/2022/03/08/bgdQcn.png"
                      alt="bgdQcn.png"
                ></a></p>
<p>可以看到，第一个参数是一个RSAKeyPair，类似于字典叭，然后第二个参数就是我们输入的密码，我们展开这个字典来看看是否还有其他线索:</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/bgwRaT"><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://s1.ax1x.com/2022/03/08/bgwRaT.png"
                      alt="bgwRaT.png"
                ></a></p>
<p>从prototype一步步展开下来，我们可以看到这个参数实际上是来自RSA.min.js执行的结果，RSA.min.js显然是开发者引入的别的包，既然它可以引入，我们也就可以扣下来，然后我们再次全局搜索key_to_encode这个参数，看看会有什么发现，如下图所示:</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/bg0Tfg"><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://s1.ax1x.com/2022/03/08/bg0Tfg.png"
                      alt="bg0Tfg.png"
                ></a></p>
<p>我们发现，上面搜索定义的函数和刚刚点击RSA.min.js跳转的函数是同一个，然后我们就可以断定，这搜索到的函数就是得到第一个参数的函数，我们跳转到这个函数，然后复制这个函数，再复制全部的RSA.min.js，我们在鬼鬼调试助手中简单构造下，看是否能成功拿到加密参数pwd:</p>
<p>以下代码是我构造好的，直接粘贴到鬼鬼调试助手中验证即可:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">setMaxDigits</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">    maxDigits = n;</span><br><span class="line">    ZERO_ARRAY = <span class="keyword">new</span> <span class="built_in">Array</span>(maxDigits);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> t = <span class="number">0</span>; t &lt; ZERO_ARRAY.length; t++)</span><br><span class="line">        ZERO_ARRAY[t] = <span class="number">0</span>;</span><br><span class="line">    bigZero = <span class="keyword">new</span> <span class="built_in">BigInt</span>;</span><br><span class="line">    bigOne = <span class="keyword">new</span> <span class="built_in">BigInt</span>;</span><br><span class="line">    bigOne.digits[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">BigInt</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.digits = <span class="keyword">typeof</span> n == <span class="string">&quot;boolean&quot;</span> &amp;&amp; n == !<span class="number">0</span> ? <span class="literal">null</span> : ZERO_ARRAY.slice(<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">this</span>.isNeg = !<span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">biFromDecimal</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> u = n.charAt(<span class="number">0</span>) == <span class="string">&quot;-&quot;</span>, t = u ? <span class="number">1</span> : <span class="number">0</span>, i, f, r; t &lt; n.length &amp;&amp; n.charAt(t) == <span class="string">&quot;0&quot;</span>; )</span><br><span class="line">        ++t;</span><br><span class="line">    <span class="keyword">if</span> (t == n.length)</span><br><span class="line">        i = <span class="keyword">new</span> <span class="built_in">BigInt</span>;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (f = n.length - t,</span><br><span class="line">        r = f % dpl10,</span><br><span class="line">        r == <span class="number">0</span> &amp;&amp; (r = dpl10),</span><br><span class="line">        i = biFromNumber(<span class="built_in">Number</span>(n.substr(t, r))),</span><br><span class="line">        t += r; t &lt; n.length; )</span><br><span class="line">            i = biAdd(biMultiply(i, lr10), biFromNumber(<span class="built_in">Number</span>(n.substr(t, dpl10)))),</span><br><span class="line">            t += dpl10;</span><br><span class="line">        i.isNeg = u</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> i</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">biCopy</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> t = <span class="keyword">new</span> <span class="built_in">BigInt</span>(!<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> t.digits = n.digits.slice(<span class="number">0</span>),</span><br><span class="line">    t.isNeg = n.isNeg,</span><br><span class="line">    t</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">biFromNumber</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> t = <span class="keyword">new</span> <span class="built_in">BigInt</span>, i;</span><br><span class="line">    <span class="keyword">for</span> (t.isNeg = n &lt; <span class="number">0</span>,</span><br><span class="line">    n = <span class="built_in">Math</span>.abs(n),</span><br><span class="line">    i = <span class="number">0</span>; n &gt; <span class="number">0</span>; )</span><br><span class="line">        t.digits[i++] = n &amp; maxDigitVal,</span><br><span class="line">        n = <span class="built_in">Math</span>.floor(n / biRadix);</span><br><span class="line">    <span class="keyword">return</span> t</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">reverseStr</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="string">&quot;&quot;</span>, t = n.length - <span class="number">1</span>; t &gt; -<span class="number">1</span>; --t)</span><br><span class="line">        i += n.charAt(t);</span><br><span class="line">    <span class="keyword">return</span> i</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">biToString</span>(<span class="params">n, t</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> r = <span class="keyword">new</span> <span class="built_in">BigInt</span>, i, u;</span><br><span class="line">    <span class="keyword">for</span> (r.digits[<span class="number">0</span>] = t,</span><br><span class="line">    i = biDivideModulo(n, r),</span><br><span class="line">    u = hexatrigesimalToChar[i[<span class="number">1</span>].digits[<span class="number">0</span>]]; biCompare(i[<span class="number">0</span>], bigZero) == <span class="number">1</span>; )</span><br><span class="line">        i = biDivideModulo(i[<span class="number">0</span>], r),</span><br><span class="line">        digit = i[<span class="number">1</span>].digits[<span class="number">0</span>],</span><br><span class="line">        u += hexatrigesimalToChar[i[<span class="number">1</span>].digits[<span class="number">0</span>]];</span><br><span class="line">    <span class="keyword">return</span> (n.isNeg ? <span class="string">&quot;-&quot;</span> : <span class="string">&quot;&quot;</span>) + reverseStr(u)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">biToDecimal</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> i = <span class="keyword">new</span> <span class="built_in">BigInt</span>, t, r;</span><br><span class="line">    <span class="keyword">for</span> (i.digits[<span class="number">0</span>] = <span class="number">10</span>,</span><br><span class="line">    t = biDivideModulo(n, i),</span><br><span class="line">    r = <span class="built_in">String</span>(t[<span class="number">1</span>].digits[<span class="number">0</span>]); biCompare(t[<span class="number">0</span>], bigZero) == <span class="number">1</span>; )</span><br><span class="line">        t = biDivideModulo(t[<span class="number">0</span>], i),</span><br><span class="line">        r += <span class="built_in">String</span>(t[<span class="number">1</span>].digits[<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">return</span> (n.isNeg ? <span class="string">&quot;-&quot;</span> : <span class="string">&quot;&quot;</span>) + reverseStr(r)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">digitToHex</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> t = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i)</span><br><span class="line">        t += hexToChar[n &amp; <span class="number">15</span>],</span><br><span class="line">        n &gt;&gt;&gt;= <span class="number">4</span>;</span><br><span class="line">    <span class="keyword">return</span> reverseStr(t)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">biToHex</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="string">&quot;&quot;</span>, r = biHighIndex(n), t = biHighIndex(n); t &gt; -<span class="number">1</span>; --t)</span><br><span class="line">        i += digitToHex(n.digits[t]);</span><br><span class="line">    <span class="keyword">return</span> i</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">charToHex</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> t = <span class="number">48</span></span><br><span class="line">      , u = t + <span class="number">9</span></span><br><span class="line">      , i = <span class="number">97</span></span><br><span class="line">      , f = i + <span class="number">25</span></span><br><span class="line">      , r = <span class="number">65</span>;</span><br><span class="line">    <span class="keyword">return</span> n &gt;= t &amp;&amp; n &lt;= u ? n - t : n &gt;= r &amp;&amp; n &lt;= <span class="number">90</span> ? <span class="number">10</span> + n - r : n &gt;= i &amp;&amp; n &lt;= f ? <span class="number">10</span> + n - i : <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">hexToDigit</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> t = <span class="number">0</span>, r = <span class="built_in">Math</span>.min(n.length, <span class="number">4</span>), i = <span class="number">0</span>; i &lt; r; ++i)</span><br><span class="line">        t &lt;&lt;= <span class="number">4</span>,</span><br><span class="line">        t |= charToHex(n.charCodeAt(i));</span><br><span class="line">    <span class="keyword">return</span> t</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">biFromHex</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="keyword">new</span> <span class="built_in">BigInt</span>, u = n.length, t = u, r = <span class="number">0</span>; t &gt; <span class="number">0</span>; t -= <span class="number">4</span>,</span><br><span class="line">    ++r)</span><br><span class="line">        i.digits[r] = hexToDigit(n.substr(<span class="built_in">Math</span>.max(t - <span class="number">4</span>, <span class="number">0</span>), <span class="built_in">Math</span>.min(t, <span class="number">4</span>)));</span><br><span class="line">    <span class="keyword">return</span> i</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">biFromString</span>(<span class="params">n, t</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> f = n.charAt(<span class="number">0</span>) == <span class="string">&quot;-&quot;</span>, e = f ? <span class="number">1</span> : <span class="number">0</span>, i = <span class="keyword">new</span> <span class="built_in">BigInt</span>, r = <span class="keyword">new</span> <span class="built_in">BigInt</span>, u;</span><br><span class="line">    <span class="keyword">for</span> (r.digits[<span class="number">0</span>] = <span class="number">1</span>,</span><br><span class="line">    u = n.length - <span class="number">1</span>; u &gt;= e; u--) &#123;</span><br><span class="line">        <span class="keyword">var</span> o = n.charCodeAt(u)</span><br><span class="line">          , s = charToHex(o)</span><br><span class="line">          , h = biMultiplyDigit(r, s);</span><br><span class="line">        i = biAdd(i, h);</span><br><span class="line">        r = biMultiplyDigit(r, t)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> i.isNeg = f,</span><br><span class="line">    i</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">biDump</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (n.isNeg ? <span class="string">&quot;-&quot;</span> : <span class="string">&quot;&quot;</span>) + n.digits.join(<span class="string">&quot; &quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">biAdd</span>(<span class="params">n, t</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> r, u, f, i;</span><br><span class="line">    <span class="keyword">if</span> (n.isNeg != t.isNeg)</span><br><span class="line">        t.isNeg = !t.isNeg,</span><br><span class="line">        r = biSubtract(n, t),</span><br><span class="line">        t.isNeg = !t.isNeg;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (r = <span class="keyword">new</span> <span class="built_in">BigInt</span>,</span><br><span class="line">        u = <span class="number">0</span>,</span><br><span class="line">        i = <span class="number">0</span>; i &lt; n.digits.length; ++i)</span><br><span class="line">            f = n.digits[i] + t.digits[i] + u,</span><br><span class="line">            r.digits[i] = f % biRadix,</span><br><span class="line">            u = <span class="built_in">Number</span>(f &gt;= biRadix);</span><br><span class="line">        r.isNeg = n.isNeg</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> r</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">biSubtract</span>(<span class="params">n, t</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> r, f, u, i;</span><br><span class="line">    <span class="keyword">if</span> (n.isNeg != t.isNeg)</span><br><span class="line">        t.isNeg = !t.isNeg,</span><br><span class="line">        r = biAdd(n, t),</span><br><span class="line">        t.isNeg = !t.isNeg;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (r = <span class="keyword">new</span> <span class="built_in">BigInt</span>,</span><br><span class="line">        u = <span class="number">0</span>,</span><br><span class="line">        i = <span class="number">0</span>; i &lt; n.digits.length; ++i)</span><br><span class="line">            f = n.digits[i] - t.digits[i] + u,</span><br><span class="line">            r.digits[i] = f % biRadix,</span><br><span class="line">            r.digits[i] &lt; <span class="number">0</span> &amp;&amp; (r.digits[i] += biRadix),</span><br><span class="line">            u = <span class="number">0</span> - <span class="built_in">Number</span>(f &lt; <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">if</span> (u == -<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (u = <span class="number">0</span>,</span><br><span class="line">            i = <span class="number">0</span>; i &lt; n.digits.length; ++i)</span><br><span class="line">                f = <span class="number">0</span> - r.digits[i] + u,</span><br><span class="line">                r.digits[i] = f % biRadix,</span><br><span class="line">                r.digits[i] &lt; <span class="number">0</span> &amp;&amp; (r.digits[i] += biRadix),</span><br><span class="line">                u = <span class="number">0</span> - <span class="built_in">Number</span>(f &lt; <span class="number">0</span>);</span><br><span class="line">            r.isNeg = !n.isNeg</span><br><span class="line">        &#125; <span class="keyword">else</span></span><br><span class="line">            r.isNeg = n.isNeg</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> r</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">biHighIndex</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> t = n.digits.length - <span class="number">1</span>; t &gt; <span class="number">0</span> &amp;&amp; n.digits[t] == <span class="number">0</span>; )</span><br><span class="line">        --t;</span><br><span class="line">    <span class="keyword">return</span> t</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">biNumBits</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = biHighIndex(n), r = n.digits[i], u = (i + <span class="number">1</span>) * bitsPerDigit, t = u; t &gt; u - bitsPerDigit; --t) &#123;</span><br><span class="line">        <span class="keyword">if</span> ((r &amp; <span class="number">32768</span>) != <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        r &lt;&lt;= <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> t</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">biMultiply</span>(<span class="params">n, t</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="keyword">new</span> <span class="built_in">BigInt</span>, u, o = biHighIndex(n), s = biHighIndex(t), e, f, r = <span class="number">0</span>; r &lt;= s; ++r) &#123;</span><br><span class="line">        <span class="keyword">for</span> (u = <span class="number">0</span>,</span><br><span class="line">        f = r,</span><br><span class="line">        j = <span class="number">0</span>; j &lt;= o; ++j,</span><br><span class="line">        ++f)</span><br><span class="line">            e = i.digits[f] + n.digits[j] * t.digits[r] + u,</span><br><span class="line">            i.digits[f] = e &amp; maxDigitVal,</span><br><span class="line">            u = e &gt;&gt;&gt; biRadixBits;</span><br><span class="line">        i.digits[r + o + <span class="number">1</span>] = u</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> i.isNeg = n.isNeg != t.isNeg,</span><br><span class="line">    i</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">biMultiplyDigit</span>(<span class="params">n, t</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> u, r, f, i;</span><br><span class="line">    <span class="keyword">for</span> (result = <span class="keyword">new</span> <span class="built_in">BigInt</span>,</span><br><span class="line">    u = biHighIndex(n),</span><br><span class="line">    r = <span class="number">0</span>,</span><br><span class="line">    i = <span class="number">0</span>; i &lt;= u; ++i)</span><br><span class="line">        f = result.digits[i] + n.digits[i] * t + r,</span><br><span class="line">        result.digits[i] = f &amp; maxDigitVal,</span><br><span class="line">        r = f &gt;&gt;&gt; biRadixBits;</span><br><span class="line">    <span class="keyword">return</span> result.digits[<span class="number">1</span> + u] = r,</span><br><span class="line">    result</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">arrayCopy</span>(<span class="params">n, t, i, r, u</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> o = <span class="built_in">Math</span>.min(t + u, n.length), f = t, e = r; f &lt; o; ++f,</span><br><span class="line">    ++e)</span><br><span class="line">        i[e] = n[f]</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">biShiftLeft</span>(<span class="params">n, t</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> e = <span class="built_in">Math</span>.floor(t / bitsPerDigit), i = <span class="keyword">new</span> <span class="built_in">BigInt</span>, u, o, r, f;</span><br><span class="line">    <span class="keyword">for</span> (arrayCopy(n.digits, <span class="number">0</span>, i.digits, e, i.digits.length - e),</span><br><span class="line">    u = t % bitsPerDigit,</span><br><span class="line">    o = bitsPerDigit - u,</span><br><span class="line">    r = i.digits.length - <span class="number">1</span>,</span><br><span class="line">    f = r - <span class="number">1</span>; r &gt; <span class="number">0</span>; --r,</span><br><span class="line">    --f)</span><br><span class="line">        i.digits[r] = i.digits[r] &lt;&lt; u &amp; maxDigitVal | (i.digits[f] &amp; highBitMasks[u]) &gt;&gt;&gt; o;</span><br><span class="line">    <span class="keyword">return</span> i.digits[<span class="number">0</span>] = i.digits[r] &lt;&lt; u &amp; maxDigitVal,</span><br><span class="line">    i.isNeg = n.isNeg,</span><br><span class="line">    i</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">biShiftRight</span>(<span class="params">n, t</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> e = <span class="built_in">Math</span>.floor(t / bitsPerDigit), i = <span class="keyword">new</span> <span class="built_in">BigInt</span>, u, o, r, f;</span><br><span class="line">    <span class="keyword">for</span> (arrayCopy(n.digits, e, i.digits, <span class="number">0</span>, n.digits.length - e),</span><br><span class="line">    u = t % bitsPerDigit,</span><br><span class="line">    o = bitsPerDigit - u,</span><br><span class="line">    r = <span class="number">0</span>,</span><br><span class="line">    f = r + <span class="number">1</span>; r &lt; i.digits.length - <span class="number">1</span>; ++r,</span><br><span class="line">    ++f)</span><br><span class="line">        i.digits[r] = i.digits[r] &gt;&gt;&gt; u | (i.digits[f] &amp; lowBitMasks[u]) &lt;&lt; o;</span><br><span class="line">    <span class="keyword">return</span> i.digits[i.digits.length - <span class="number">1</span>] &gt;&gt;&gt;= u,</span><br><span class="line">    i.isNeg = n.isNeg,</span><br><span class="line">    i</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">biMultiplyByRadixPower</span>(<span class="params">n, t</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> i = <span class="keyword">new</span> <span class="built_in">BigInt</span>;</span><br><span class="line">    <span class="keyword">return</span> arrayCopy(n.digits, <span class="number">0</span>, i.digits, t, i.digits.length - t),</span><br><span class="line">    i</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">biDivideByRadixPower</span>(<span class="params">n, t</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> i = <span class="keyword">new</span> <span class="built_in">BigInt</span>;</span><br><span class="line">    <span class="keyword">return</span> arrayCopy(n.digits, t, i.digits, <span class="number">0</span>, i.digits.length - t),</span><br><span class="line">    i</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">biModuloByRadixPower</span>(<span class="params">n, t</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> i = <span class="keyword">new</span> <span class="built_in">BigInt</span>;</span><br><span class="line">    <span class="keyword">return</span> arrayCopy(n.digits, <span class="number">0</span>, i.digits, <span class="number">0</span>, t),</span><br><span class="line">    i</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">biCompare</span>(<span class="params">n, t</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n.isNeg != t.isNeg)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span> - <span class="number">2</span> * <span class="built_in">Number</span>(n.isNeg);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = n.digits.length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i)</span><br><span class="line">        <span class="keyword">if</span> (n.digits[i] != t.digits[i])</span><br><span class="line">            <span class="keyword">return</span> n.isNeg ? <span class="number">1</span> - <span class="number">2</span> * <span class="built_in">Number</span>(n.digits[i] &gt; t.digits[i]) : <span class="number">1</span> - <span class="number">2</span> * <span class="built_in">Number</span>(n.digits[i] &lt; t.digits[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">biDivideModulo</span>(<span class="params">n, t</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a = biNumBits(n), s = biNumBits(t), v = t.isNeg, r, i, u, e, h, o, f, y, p;</span><br><span class="line">    <span class="keyword">if</span> (a &lt; s)</span><br><span class="line">        <span class="keyword">return</span> n.isNeg ? (r = biCopy(bigOne),</span><br><span class="line">        r.isNeg = !t.isNeg,</span><br><span class="line">        n.isNeg = !<span class="number">1</span>,</span><br><span class="line">        t.isNeg = !<span class="number">1</span>,</span><br><span class="line">        i = biSubtract(t, n),</span><br><span class="line">        n.isNeg = !<span class="number">0</span>,</span><br><span class="line">        t.isNeg = v) : (r = <span class="keyword">new</span> <span class="built_in">BigInt</span>,</span><br><span class="line">        i = biCopy(n)),</span><br><span class="line">        [r, i];</span><br><span class="line">    <span class="keyword">for</span> (r = <span class="keyword">new</span> <span class="built_in">BigInt</span>,</span><br><span class="line">    i = n,</span><br><span class="line">    u = <span class="built_in">Math</span>.ceil(s / bitsPerDigit) - <span class="number">1</span>,</span><br><span class="line">    e = <span class="number">0</span>; t.digits[u] &lt; biHalfRadix; )</span><br><span class="line">        t = biShiftLeft(t, <span class="number">1</span>),</span><br><span class="line">        ++e,</span><br><span class="line">        ++s,</span><br><span class="line">        u = <span class="built_in">Math</span>.ceil(s / bitsPerDigit) - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = biShiftLeft(i, e),</span><br><span class="line">    a += e,</span><br><span class="line">    h = <span class="built_in">Math</span>.ceil(a / bitsPerDigit) - <span class="number">1</span>,</span><br><span class="line">    o = biMultiplyByRadixPower(t, h - u); biCompare(i, o) != -<span class="number">1</span>; )</span><br><span class="line">        ++r.digits[h - u],</span><br><span class="line">        i = biSubtract(i, o);</span><br><span class="line">    <span class="keyword">for</span> (f = h; f &gt; u; --f) &#123;</span><br><span class="line">        <span class="keyword">var</span> c = f &gt;= i.digits.length ? <span class="number">0</span> : i.digits[f]</span><br><span class="line">          , w = f - <span class="number">1</span> &gt;= i.digits.length ? <span class="number">0</span> : i.digits[f - <span class="number">1</span>]</span><br><span class="line">          , b = f - <span class="number">2</span> &gt;= i.digits.length ? <span class="number">0</span> : i.digits[f - <span class="number">2</span>]</span><br><span class="line">          , l = u &gt;= t.digits.length ? <span class="number">0</span> : t.digits[u]</span><br><span class="line">          , k = u - <span class="number">1</span> &gt;= t.digits.length ? <span class="number">0</span> : t.digits[u - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (r.digits[f - u - <span class="number">1</span>] = c == l ? maxDigitVal : <span class="built_in">Math</span>.floor((c * biRadix + w) / l),</span><br><span class="line">        y = r.digits[f - u - <span class="number">1</span>] * (l * biRadix + k),</span><br><span class="line">        p = c * biRadixSquared + (w * biRadix + b); y &gt; p; )</span><br><span class="line">            --r.digits[f - u - <span class="number">1</span>],</span><br><span class="line">            y = r.digits[f - u - <span class="number">1</span>] * (l * biRadix | k),</span><br><span class="line">            p = c * biRadix * biRadix + (w * biRadix + b);</span><br><span class="line">        o = biMultiplyByRadixPower(t, f - u - <span class="number">1</span>);</span><br><span class="line">        i = biSubtract(i, biMultiplyDigit(o, r.digits[f - u - <span class="number">1</span>]));</span><br><span class="line">        i.isNeg &amp;&amp; (i = biAdd(i, o),</span><br><span class="line">        --r.digits[f - u - <span class="number">1</span>])</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> i = biShiftRight(i, e),</span><br><span class="line">    r.isNeg = n.isNeg != v,</span><br><span class="line">    n.isNeg &amp;&amp; (r = v ? biAdd(r, bigOne) : biSubtract(r, bigOne),</span><br><span class="line">    t = biShiftRight(t, e),</span><br><span class="line">    i = biSubtract(t, i)),</span><br><span class="line">    i.digits[<span class="number">0</span>] == <span class="number">0</span> &amp;&amp; biHighIndex(i) == <span class="number">0</span> &amp;&amp; (i.isNeg = !<span class="number">1</span>),</span><br><span class="line">    [r, i]</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">biDivide</span>(<span class="params">n, t</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> biDivideModulo(n, t)[<span class="number">0</span>]</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">biModulo</span>(<span class="params">n, t</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> biDivideModulo(n, t)[<span class="number">1</span>]</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">biMultiplyMod</span>(<span class="params">n, t, i</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> biModulo(biMultiply(n, t), i)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">biPow</span>(<span class="params">n, t</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> r = bigOne, i = n; ; ) &#123;</span><br><span class="line">        <span class="keyword">if</span> ((t &amp; <span class="number">1</span>) != <span class="number">0</span> &amp;&amp; (r = biMultiply(r, i)),</span><br><span class="line">        t &gt;&gt;= <span class="number">1</span>,</span><br><span class="line">        t == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        i = biMultiply(i, i)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> r</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">biPowMod</span>(<span class="params">n, t, i</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> f = bigOne, u = n, r = t; ; ) &#123;</span><br><span class="line">        <span class="keyword">if</span> ((r.digits[<span class="number">0</span>] &amp; <span class="number">1</span>) != <span class="number">0</span> &amp;&amp; (f = biMultiplyMod(f, u, i)),</span><br><span class="line">        r = biShiftRight(r, <span class="number">1</span>),</span><br><span class="line">        r.digits[<span class="number">0</span>] == <span class="number">0</span> &amp;&amp; biHighIndex(r) == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        u = biMultiplyMod(u, u, i)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> f</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">BarrettMu</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.modulus = biCopy(n);</span><br><span class="line">    <span class="built_in">this</span>.k = biHighIndex(<span class="built_in">this</span>.modulus) + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">var</span> t = <span class="keyword">new</span> <span class="built_in">BigInt</span>;</span><br><span class="line">    t.digits[<span class="number">2</span> * <span class="built_in">this</span>.k] = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">this</span>.mu = biDivide(t, <span class="built_in">this</span>.modulus);</span><br><span class="line">    <span class="built_in">this</span>.bkplus1 = <span class="keyword">new</span> <span class="built_in">BigInt</span>;</span><br><span class="line">    <span class="built_in">this</span>.bkplus1.digits[<span class="built_in">this</span>.k + <span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">this</span>.modulo = BarrettMu_modulo;</span><br><span class="line">    <span class="built_in">this</span>.multiplyMod = BarrettMu_multiplyMod;</span><br><span class="line">    <span class="built_in">this</span>.powMod = BarrettMu_powMod</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">BarrettMu_modulo</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> r = biDivideByRadixPower(n, <span class="built_in">this</span>.k - <span class="number">1</span>), u = biMultiply(r, <span class="built_in">this</span>.mu), f = biDivideByRadixPower(u, <span class="built_in">this</span>.k + <span class="number">1</span>), e = biModuloByRadixPower(n, <span class="built_in">this</span>.k + <span class="number">1</span>), o = biMultiply(f, <span class="built_in">this</span>.modulus), s = biModuloByRadixPower(o, <span class="built_in">this</span>.k + <span class="number">1</span>), t = biSubtract(e, s), i;</span><br><span class="line">    <span class="keyword">for</span> (t.isNeg &amp;&amp; (t = biAdd(t, <span class="built_in">this</span>.bkplus1)),</span><br><span class="line">    i = biCompare(t, <span class="built_in">this</span>.modulus) &gt;= <span class="number">0</span>; i; )</span><br><span class="line">        t = biSubtract(t, <span class="built_in">this</span>.modulus),</span><br><span class="line">        i = biCompare(t, <span class="built_in">this</span>.modulus) &gt;= <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> t</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">BarrettMu_multiplyMod</span>(<span class="params">n, t</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> i = biMultiply(n, t);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.modulo(i)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">BarrettMu_powMod</span>(<span class="params">n, t</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> u = <span class="keyword">new</span> <span class="built_in">BigInt</span>, r, i;</span><br><span class="line">    <span class="keyword">for</span> (u.digits[<span class="number">0</span>] = <span class="number">1</span>,</span><br><span class="line">    r = n,</span><br><span class="line">    i = t; ; ) &#123;</span><br><span class="line">        <span class="keyword">if</span> ((i.digits[<span class="number">0</span>] &amp; <span class="number">1</span>) != <span class="number">0</span> &amp;&amp; (u = <span class="built_in">this</span>.multiplyMod(u, r)),</span><br><span class="line">        i = biShiftRight(i, <span class="number">1</span>),</span><br><span class="line">        i.digits[<span class="number">0</span>] == <span class="number">0</span> &amp;&amp; biHighIndex(i) == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        r = <span class="built_in">this</span>.multiplyMod(r, r)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> u</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">RSAKeyPair</span>(<span class="params">n, t, i</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.e = biFromHex(n);</span><br><span class="line">    <span class="built_in">this</span>.d = biFromHex(t);</span><br><span class="line">    <span class="built_in">this</span>.m = biFromHex(i);</span><br><span class="line">    <span class="built_in">this</span>.digitSize = <span class="number">2</span> * biHighIndex(<span class="built_in">this</span>.m) + <span class="number">2</span>;</span><br><span class="line">    <span class="built_in">this</span>.chunkSize = <span class="built_in">this</span>.digitSize - <span class="number">11</span>;</span><br><span class="line">    <span class="built_in">this</span>.radix = <span class="number">16</span>;</span><br><span class="line">    <span class="built_in">this</span>.barrett = <span class="keyword">new</span> BarrettMu(<span class="built_in">this</span>.m)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">twoDigit</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (n &lt; <span class="number">10</span> ? <span class="string">&quot;0&quot;</span> : <span class="string">&quot;&quot;</span>) + <span class="built_in">String</span>(n)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encryptedString</span>(<span class="params">n, t</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> e, o, s, h, c, i, f, u, v, l, y;</span><br><span class="line">    <span class="keyword">if</span> (n.chunkSize &gt; n.digitSize - <span class="number">11</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Error&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> a = [], p = t.length, r = <span class="number">0</span>; r &lt; p; )</span><br><span class="line">        a[r] = t.charCodeAt(r),</span><br><span class="line">        r++;</span><br><span class="line">    <span class="keyword">for</span> (e = a.length,</span><br><span class="line">    o = <span class="string">&quot;&quot;</span>,</span><br><span class="line">    r = <span class="number">0</span>; r &lt; e; r += n.chunkSize) &#123;</span><br><span class="line">        <span class="keyword">for</span> (c = <span class="keyword">new</span> <span class="built_in">BigInt</span>,</span><br><span class="line">        s = <span class="number">0</span>,</span><br><span class="line">        f = r + n.chunkSize &gt; e ? e % n.chunkSize : n.chunkSize,</span><br><span class="line">        u = [],</span><br><span class="line">        i = <span class="number">0</span>; i &lt; f; i++)</span><br><span class="line">            u[i] = a[r + f - <span class="number">1</span> - i];</span><br><span class="line">        <span class="keyword">for</span> (u[f] = <span class="number">0</span>,</span><br><span class="line">        v = <span class="built_in">Math</span>.max(<span class="number">8</span>, n.digitSize - <span class="number">3</span> - f),</span><br><span class="line">        i = <span class="number">0</span>; i &lt; v; i++)</span><br><span class="line">            u[f + <span class="number">1</span> + i] = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">254</span>) + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (u[n.digitSize - <span class="number">2</span>] = <span class="number">2</span>,</span><br><span class="line">        u[n.digitSize - <span class="number">1</span>] = <span class="number">0</span>,</span><br><span class="line">        h = <span class="number">0</span>; h &lt; n.digitSize; ++s)</span><br><span class="line">            c.digits[s] = u[h++],</span><br><span class="line">            c.digits[s] += u[h++] &lt;&lt; <span class="number">8</span>;</span><br><span class="line">        l = n.barrett.powMod(c, n.e);</span><br><span class="line">        y = n.radix == <span class="number">16</span> ? biToHex(l) : biToString(l, n.radix);</span><br><span class="line">        o += y + <span class="string">&quot; &quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> o.substring(<span class="number">0</span>, o.length - <span class="number">1</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">decryptedString</span>(<span class="params">n, t</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> e = t.split(<span class="string">&quot; &quot;</span>), i = <span class="string">&quot;&quot;</span>, r, u, o, f = <span class="number">0</span>; f &lt; e.length; ++f)</span><br><span class="line">        <span class="keyword">for</span> (o = n.radix == <span class="number">16</span> ? biFromHex(e[f]) : biFromString(e[f], n.radix),</span><br><span class="line">        u = n.barrett.powMod(o, n.d),</span><br><span class="line">        r = <span class="number">0</span>; r &lt;= biHighIndex(u); ++r)</span><br><span class="line">            i += <span class="built_in">String</span>.fromCharCode(u.digits[r] &amp; <span class="number">255</span>, u.digits[r] &gt;&gt; <span class="number">8</span>);</span><br><span class="line">    <span class="keyword">return</span> i.charCodeAt(i.length - <span class="number">1</span>) == <span class="number">0</span> &amp;&amp; (i = i.substring(<span class="number">0</span>, i.length - <span class="number">1</span>)),</span><br><span class="line">    i</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> biRadixBase = <span class="number">2</span>, biRadixBits = <span class="number">16</span>, bitsPerDigit = biRadixBits, biRadix = <span class="number">65536</span>, biHalfRadix = biRadix &gt;&gt;&gt; <span class="number">1</span>, biRadixSquared = biRadix * biRadix, maxDigitVal = biRadix - <span class="number">1</span>, maxInteger = <span class="number">9999999999999998</span>, maxDigits, ZERO_ARRAY, bigZero, bigOne, dpl10, lr10, hexatrigesimalToChar, hexToChar, highBitMasks, lowBitMasks;</span><br><span class="line">setMaxDigits(<span class="number">20</span>);</span><br><span class="line">dpl10 = <span class="number">15</span>;</span><br><span class="line">lr10 = biFromNumber(<span class="number">1e15</span>);</span><br><span class="line">hexatrigesimalToChar = [<span class="string">&quot;0&quot;</span>, <span class="string">&quot;1&quot;</span>, <span class="string">&quot;2&quot;</span>, <span class="string">&quot;3&quot;</span>, <span class="string">&quot;4&quot;</span>, <span class="string">&quot;5&quot;</span>, <span class="string">&quot;6&quot;</span>, <span class="string">&quot;7&quot;</span>, <span class="string">&quot;8&quot;</span>, <span class="string">&quot;9&quot;</span>, <span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>, <span class="string">&quot;d&quot;</span>, <span class="string">&quot;e&quot;</span>, <span class="string">&quot;f&quot;</span>, <span class="string">&quot;g&quot;</span>, <span class="string">&quot;h&quot;</span>, <span class="string">&quot;i&quot;</span>, <span class="string">&quot;j&quot;</span>, <span class="string">&quot;k&quot;</span>, <span class="string">&quot;l&quot;</span>, <span class="string">&quot;m&quot;</span>, <span class="string">&quot;n&quot;</span>, <span class="string">&quot;o&quot;</span>, <span class="string">&quot;p&quot;</span>, <span class="string">&quot;q&quot;</span>, <span class="string">&quot;r&quot;</span>, <span class="string">&quot;s&quot;</span>, <span class="string">&quot;t&quot;</span>, <span class="string">&quot;u&quot;</span>, <span class="string">&quot;v&quot;</span>, <span class="string">&quot;w&quot;</span>, <span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>, <span class="string">&quot;z&quot;</span>];</span><br><span class="line">hexToChar = [<span class="string">&quot;0&quot;</span>, <span class="string">&quot;1&quot;</span>, <span class="string">&quot;2&quot;</span>, <span class="string">&quot;3&quot;</span>, <span class="string">&quot;4&quot;</span>, <span class="string">&quot;5&quot;</span>, <span class="string">&quot;6&quot;</span>, <span class="string">&quot;7&quot;</span>, <span class="string">&quot;8&quot;</span>, <span class="string">&quot;9&quot;</span>, <span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>, <span class="string">&quot;d&quot;</span>, <span class="string">&quot;e&quot;</span>, <span class="string">&quot;f&quot;</span>];</span><br><span class="line">highBitMasks = [<span class="number">0</span>, <span class="number">32768</span>, <span class="number">49152</span>, <span class="number">57344</span>, <span class="number">61440</span>, <span class="number">63488</span>, <span class="number">64512</span>, <span class="number">65024</span>, <span class="number">65280</span>, <span class="number">65408</span>, <span class="number">65472</span>, <span class="number">65504</span>, <span class="number">65520</span>, <span class="number">65528</span>, <span class="number">65532</span>, <span class="number">65534</span>, <span class="number">65535</span>];</span><br><span class="line">lowBitMasks = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">15</span>, <span class="number">31</span>, <span class="number">63</span>, <span class="number">127</span>, <span class="number">255</span>, <span class="number">511</span>, <span class="number">1023</span>, <span class="number">2047</span>, <span class="number">4095</span>, <span class="number">8191</span>, <span class="number">16383</span>, <span class="number">32767</span>, <span class="number">65535</span>];</span><br><span class="line">setMaxDigits(<span class="number">129</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getpwd</span>(<span class="params">pwd</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> key_to_encode = <span class="keyword">new</span> RSAKeyPair(<span class="string">&quot;010001&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="string">&quot;978C0A92D2173439707498F0944AA476B1B62595877DD6FA87F6E2AC6DCB3D0BF0B82857439C99B5091192BC134889DFF60C562EC54EFBA4FF2F9D55ADBCCEA4A2FBA80CB398ED501280A007C83AF30C3D1A142D6133C63012B90AB26AC60C898FB66EDC3192C3EC4FF66925A64003B72496099F4F09A9FB72A2CF9E4D770C41&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> encryptedString(key_to_encode, pwd)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在鬼鬼调试助手上我们可以看到如下运行效果:</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/bgDcqI"><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://s1.ax1x.com/2022/03/08/bgDcqI.png"
                      alt="bgDcqI.png"
                ></a></p>
<h3 id="Python模拟执行"><a href="#Python模拟执行" class="headerlink" title="Python模拟执行"></a>Python模拟执行</h3><p>我在房天下注册了个账号: 18979685***，然后我们来测试下</p>
<ul>
<li><p>get_encrypted_pwd.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">@Description : </span></span><br><span class="line"><span class="string">@File        : get_encrypted_pwd</span></span><br><span class="line"><span class="string">@Project     : test</span></span><br><span class="line"><span class="string">@Time        : 2022/3/8 18:16</span></span><br><span class="line"><span class="string">@Author      : LiHouJian</span></span><br><span class="line"><span class="string">@Software    : PyCharm</span></span><br><span class="line"><span class="string">@issue       : </span></span><br><span class="line"><span class="string">@change      : </span></span><br><span class="line"><span class="string">@reason      : </span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> scrapy</span><br><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> traceback</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> scrapy.utils <span class="keyword">import</span> request</span><br><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> etree</span><br><span class="line"><span class="keyword">from</span> scrapy.utils.project <span class="keyword">import</span> get_project_settings</span><br><span class="line"><span class="keyword">from</span> pybase.util <span class="keyword">import</span> send_file</span><br><span class="line"><span class="keyword">import</span> execjs</span><br><span class="line"></span><br><span class="line">jscode = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">function setMaxDigits(n) &#123;</span></span><br><span class="line"><span class="string">    maxDigits = n;</span></span><br><span class="line"><span class="string">    ZERO_ARRAY = new Array(maxDigits);</span></span><br><span class="line"><span class="string">    for (var t = 0; t &lt; ZERO_ARRAY.length; t++)</span></span><br><span class="line"><span class="string">        ZERO_ARRAY[t] = 0;</span></span><br><span class="line"><span class="string">    bigZero = new BigInt;</span></span><br><span class="line"><span class="string">    bigOne = new BigInt;</span></span><br><span class="line"><span class="string">    bigOne.digits[0] = 1</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">function BigInt(n) &#123;</span></span><br><span class="line"><span class="string">    this.digits = typeof n == &quot;boolean&quot; &amp;&amp; n == !0 ? null : ZERO_ARRAY.slice(0);</span></span><br><span class="line"><span class="string">    this.isNeg = !1</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">function biFromDecimal(n) &#123;</span></span><br><span class="line"><span class="string">    for (var u = n.charAt(0) == &quot;-&quot;, t = u ? 1 : 0, i, f, r; t &lt; n.length &amp;&amp; n.charAt(t) == &quot;0&quot;; )</span></span><br><span class="line"><span class="string">        ++t;</span></span><br><span class="line"><span class="string">    if (t == n.length)</span></span><br><span class="line"><span class="string">        i = new BigInt;</span></span><br><span class="line"><span class="string">    else &#123;</span></span><br><span class="line"><span class="string">        for (f = n.length - t,</span></span><br><span class="line"><span class="string">        r = f % dpl10,</span></span><br><span class="line"><span class="string">        r == 0 &amp;&amp; (r = dpl10),</span></span><br><span class="line"><span class="string">        i = biFromNumber(Number(n.substr(t, r))),</span></span><br><span class="line"><span class="string">        t += r; t &lt; n.length; )</span></span><br><span class="line"><span class="string">            i = biAdd(biMultiply(i, lr10), biFromNumber(Number(n.substr(t, dpl10)))),</span></span><br><span class="line"><span class="string">            t += dpl10;</span></span><br><span class="line"><span class="string">        i.isNeg = u</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    return i</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">function biCopy(n) &#123;</span></span><br><span class="line"><span class="string">    var t = new BigInt(!0);</span></span><br><span class="line"><span class="string">    return t.digits = n.digits.slice(0),</span></span><br><span class="line"><span class="string">    t.isNeg = n.isNeg,</span></span><br><span class="line"><span class="string">    t</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">function biFromNumber(n) &#123;</span></span><br><span class="line"><span class="string">    var t = new BigInt, i;</span></span><br><span class="line"><span class="string">    for (t.isNeg = n &lt; 0,</span></span><br><span class="line"><span class="string">    n = Math.abs(n),</span></span><br><span class="line"><span class="string">    i = 0; n &gt; 0; )</span></span><br><span class="line"><span class="string">        t.digits[i++] = n &amp; maxDigitVal,</span></span><br><span class="line"><span class="string">        n = Math.floor(n / biRadix);</span></span><br><span class="line"><span class="string">    return t</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">function reverseStr(n) &#123;</span></span><br><span class="line"><span class="string">    for (var i = &quot;&quot;, t = n.length - 1; t &gt; -1; --t)</span></span><br><span class="line"><span class="string">        i += n.charAt(t);</span></span><br><span class="line"><span class="string">    return i</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">function biToString(n, t) &#123;</span></span><br><span class="line"><span class="string">    var r = new BigInt, i, u;</span></span><br><span class="line"><span class="string">    for (r.digits[0] = t,</span></span><br><span class="line"><span class="string">    i = biDivideModulo(n, r),</span></span><br><span class="line"><span class="string">    u = hexatrigesimalToChar[i[1].digits[0]]; biCompare(i[0], bigZero) == 1; )</span></span><br><span class="line"><span class="string">        i = biDivideModulo(i[0], r),</span></span><br><span class="line"><span class="string">        digit = i[1].digits[0],</span></span><br><span class="line"><span class="string">        u += hexatrigesimalToChar[i[1].digits[0]];</span></span><br><span class="line"><span class="string">    return (n.isNeg ? &quot;-&quot; : &quot;&quot;) + reverseStr(u)</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">function biToDecimal(n) &#123;</span></span><br><span class="line"><span class="string">    var i = new BigInt, t, r;</span></span><br><span class="line"><span class="string">    for (i.digits[0] = 10,</span></span><br><span class="line"><span class="string">    t = biDivideModulo(n, i),</span></span><br><span class="line"><span class="string">    r = String(t[1].digits[0]); biCompare(t[0], bigZero) == 1; )</span></span><br><span class="line"><span class="string">        t = biDivideModulo(t[0], i),</span></span><br><span class="line"><span class="string">        r += String(t[1].digits[0]);</span></span><br><span class="line"><span class="string">    return (n.isNeg ? &quot;-&quot; : &quot;&quot;) + reverseStr(r)</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">function digitToHex(n) &#123;</span></span><br><span class="line"><span class="string">    var t = &quot;&quot;;</span></span><br><span class="line"><span class="string">    for (i = 0; i &lt; 4; ++i)</span></span><br><span class="line"><span class="string">        t += hexToChar[n &amp; 15],</span></span><br><span class="line"><span class="string">        n &gt;&gt;&gt;= 4;</span></span><br><span class="line"><span class="string">    return reverseStr(t)</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">function biToHex(n) &#123;</span></span><br><span class="line"><span class="string">    for (var i = &quot;&quot;, r = biHighIndex(n), t = biHighIndex(n); t &gt; -1; --t)</span></span><br><span class="line"><span class="string">        i += digitToHex(n.digits[t]);</span></span><br><span class="line"><span class="string">    return i</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">function charToHex(n) &#123;</span></span><br><span class="line"><span class="string">    var t = 48</span></span><br><span class="line"><span class="string">      , u = t + 9</span></span><br><span class="line"><span class="string">      , i = 97</span></span><br><span class="line"><span class="string">      , f = i + 25</span></span><br><span class="line"><span class="string">      , r = 65;</span></span><br><span class="line"><span class="string">    return n &gt;= t &amp;&amp; n &lt;= u ? n - t : n &gt;= r &amp;&amp; n &lt;= 90 ? 10 + n - r : n &gt;= i &amp;&amp; n &lt;= f ? 10 + n - i : 0</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">function hexToDigit(n) &#123;</span></span><br><span class="line"><span class="string">    for (var t = 0, r = Math.min(n.length, 4), i = 0; i &lt; r; ++i)</span></span><br><span class="line"><span class="string">        t &lt;&lt;= 4,</span></span><br><span class="line"><span class="string">        t |= charToHex(n.charCodeAt(i));</span></span><br><span class="line"><span class="string">    return t</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">function biFromHex(n) &#123;</span></span><br><span class="line"><span class="string">    for (var i = new BigInt, u = n.length, t = u, r = 0; t &gt; 0; t -= 4,</span></span><br><span class="line"><span class="string">    ++r)</span></span><br><span class="line"><span class="string">        i.digits[r] = hexToDigit(n.substr(Math.max(t - 4, 0), Math.min(t, 4)));</span></span><br><span class="line"><span class="string">    return i</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">function biFromString(n, t) &#123;</span></span><br><span class="line"><span class="string">    var f = n.charAt(0) == &quot;-&quot;, e = f ? 1 : 0, i = new BigInt, r = new BigInt, u;</span></span><br><span class="line"><span class="string">    for (r.digits[0] = 1,</span></span><br><span class="line"><span class="string">    u = n.length - 1; u &gt;= e; u--) &#123;</span></span><br><span class="line"><span class="string">        var o = n.charCodeAt(u)</span></span><br><span class="line"><span class="string">          , s = charToHex(o)</span></span><br><span class="line"><span class="string">          , h = biMultiplyDigit(r, s);</span></span><br><span class="line"><span class="string">        i = biAdd(i, h);</span></span><br><span class="line"><span class="string">        r = biMultiplyDigit(r, t)</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    return i.isNeg = f,</span></span><br><span class="line"><span class="string">    i</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">function biDump(n) &#123;</span></span><br><span class="line"><span class="string">    return (n.isNeg ? &quot;-&quot; : &quot;&quot;) + n.digits.join(&quot; &quot;)</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">function biAdd(n, t) &#123;</span></span><br><span class="line"><span class="string">    var r, u, f, i;</span></span><br><span class="line"><span class="string">    if (n.isNeg != t.isNeg)</span></span><br><span class="line"><span class="string">        t.isNeg = !t.isNeg,</span></span><br><span class="line"><span class="string">        r = biSubtract(n, t),</span></span><br><span class="line"><span class="string">        t.isNeg = !t.isNeg;</span></span><br><span class="line"><span class="string">    else &#123;</span></span><br><span class="line"><span class="string">        for (r = new BigInt,</span></span><br><span class="line"><span class="string">        u = 0,</span></span><br><span class="line"><span class="string">        i = 0; i &lt; n.digits.length; ++i)</span></span><br><span class="line"><span class="string">            f = n.digits[i] + t.digits[i] + u,</span></span><br><span class="line"><span class="string">            r.digits[i] = f % biRadix,</span></span><br><span class="line"><span class="string">            u = Number(f &gt;= biRadix);</span></span><br><span class="line"><span class="string">        r.isNeg = n.isNeg</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    return r</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">function biSubtract(n, t) &#123;</span></span><br><span class="line"><span class="string">    var r, f, u, i;</span></span><br><span class="line"><span class="string">    if (n.isNeg != t.isNeg)</span></span><br><span class="line"><span class="string">        t.isNeg = !t.isNeg,</span></span><br><span class="line"><span class="string">        r = biAdd(n, t),</span></span><br><span class="line"><span class="string">        t.isNeg = !t.isNeg;</span></span><br><span class="line"><span class="string">    else &#123;</span></span><br><span class="line"><span class="string">        for (r = new BigInt,</span></span><br><span class="line"><span class="string">        u = 0,</span></span><br><span class="line"><span class="string">        i = 0; i &lt; n.digits.length; ++i)</span></span><br><span class="line"><span class="string">            f = n.digits[i] - t.digits[i] + u,</span></span><br><span class="line"><span class="string">            r.digits[i] = f % biRadix,</span></span><br><span class="line"><span class="string">            r.digits[i] &lt; 0 &amp;&amp; (r.digits[i] += biRadix),</span></span><br><span class="line"><span class="string">            u = 0 - Number(f &lt; 0);</span></span><br><span class="line"><span class="string">        if (u == -1) &#123;</span></span><br><span class="line"><span class="string">            for (u = 0,</span></span><br><span class="line"><span class="string">            i = 0; i &lt; n.digits.length; ++i)</span></span><br><span class="line"><span class="string">                f = 0 - r.digits[i] + u,</span></span><br><span class="line"><span class="string">                r.digits[i] = f % biRadix,</span></span><br><span class="line"><span class="string">                r.digits[i] &lt; 0 &amp;&amp; (r.digits[i] += biRadix),</span></span><br><span class="line"><span class="string">                u = 0 - Number(f &lt; 0);</span></span><br><span class="line"><span class="string">            r.isNeg = !n.isNeg</span></span><br><span class="line"><span class="string">        &#125; else</span></span><br><span class="line"><span class="string">            r.isNeg = n.isNeg</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    return r</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">function biHighIndex(n) &#123;</span></span><br><span class="line"><span class="string">    for (var t = n.digits.length - 1; t &gt; 0 &amp;&amp; n.digits[t] == 0; )</span></span><br><span class="line"><span class="string">        --t;</span></span><br><span class="line"><span class="string">    return t</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">function biNumBits(n) &#123;</span></span><br><span class="line"><span class="string">    for (var i = biHighIndex(n), r = n.digits[i], u = (i + 1) * bitsPerDigit, t = u; t &gt; u - bitsPerDigit; --t) &#123;</span></span><br><span class="line"><span class="string">        if ((r &amp; 32768) != 0)</span></span><br><span class="line"><span class="string">            break;</span></span><br><span class="line"><span class="string">        r &lt;&lt;= 1</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    return t</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">function biMultiply(n, t) &#123;</span></span><br><span class="line"><span class="string">    for (var i = new BigInt, u, o = biHighIndex(n), s = biHighIndex(t), e, f, r = 0; r &lt;= s; ++r) &#123;</span></span><br><span class="line"><span class="string">        for (u = 0,</span></span><br><span class="line"><span class="string">        f = r,</span></span><br><span class="line"><span class="string">        j = 0; j &lt;= o; ++j,</span></span><br><span class="line"><span class="string">        ++f)</span></span><br><span class="line"><span class="string">            e = i.digits[f] + n.digits[j] * t.digits[r] + u,</span></span><br><span class="line"><span class="string">            i.digits[f] = e &amp; maxDigitVal,</span></span><br><span class="line"><span class="string">            u = e &gt;&gt;&gt; biRadixBits;</span></span><br><span class="line"><span class="string">        i.digits[r + o + 1] = u</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    return i.isNeg = n.isNeg != t.isNeg,</span></span><br><span class="line"><span class="string">    i</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">function biMultiplyDigit(n, t) &#123;</span></span><br><span class="line"><span class="string">    var u, r, f, i;</span></span><br><span class="line"><span class="string">    for (result = new BigInt,</span></span><br><span class="line"><span class="string">    u = biHighIndex(n),</span></span><br><span class="line"><span class="string">    r = 0,</span></span><br><span class="line"><span class="string">    i = 0; i &lt;= u; ++i)</span></span><br><span class="line"><span class="string">        f = result.digits[i] + n.digits[i] * t + r,</span></span><br><span class="line"><span class="string">        result.digits[i] = f &amp; maxDigitVal,</span></span><br><span class="line"><span class="string">        r = f &gt;&gt;&gt; biRadixBits;</span></span><br><span class="line"><span class="string">    return result.digits[1 + u] = r,</span></span><br><span class="line"><span class="string">    result</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">function arrayCopy(n, t, i, r, u) &#123;</span></span><br><span class="line"><span class="string">    for (var o = Math.min(t + u, n.length), f = t, e = r; f &lt; o; ++f,</span></span><br><span class="line"><span class="string">    ++e)</span></span><br><span class="line"><span class="string">        i[e] = n[f]</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">function biShiftLeft(n, t) &#123;</span></span><br><span class="line"><span class="string">    var e = Math.floor(t / bitsPerDigit), i = new BigInt, u, o, r, f;</span></span><br><span class="line"><span class="string">    for (arrayCopy(n.digits, 0, i.digits, e, i.digits.length - e),</span></span><br><span class="line"><span class="string">    u = t % bitsPerDigit,</span></span><br><span class="line"><span class="string">    o = bitsPerDigit - u,</span></span><br><span class="line"><span class="string">    r = i.digits.length - 1,</span></span><br><span class="line"><span class="string">    f = r - 1; r &gt; 0; --r,</span></span><br><span class="line"><span class="string">    --f)</span></span><br><span class="line"><span class="string">        i.digits[r] = i.digits[r] &lt;&lt; u &amp; maxDigitVal | (i.digits[f] &amp; highBitMasks[u]) &gt;&gt;&gt; o;</span></span><br><span class="line"><span class="string">    return i.digits[0] = i.digits[r] &lt;&lt; u &amp; maxDigitVal,</span></span><br><span class="line"><span class="string">    i.isNeg = n.isNeg,</span></span><br><span class="line"><span class="string">    i</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">function biShiftRight(n, t) &#123;</span></span><br><span class="line"><span class="string">    var e = Math.floor(t / bitsPerDigit), i = new BigInt, u, o, r, f;</span></span><br><span class="line"><span class="string">    for (arrayCopy(n.digits, e, i.digits, 0, n.digits.length - e),</span></span><br><span class="line"><span class="string">    u = t % bitsPerDigit,</span></span><br><span class="line"><span class="string">    o = bitsPerDigit - u,</span></span><br><span class="line"><span class="string">    r = 0,</span></span><br><span class="line"><span class="string">    f = r + 1; r &lt; i.digits.length - 1; ++r,</span></span><br><span class="line"><span class="string">    ++f)</span></span><br><span class="line"><span class="string">        i.digits[r] = i.digits[r] &gt;&gt;&gt; u | (i.digits[f] &amp; lowBitMasks[u]) &lt;&lt; o;</span></span><br><span class="line"><span class="string">    return i.digits[i.digits.length - 1] &gt;&gt;&gt;= u,</span></span><br><span class="line"><span class="string">    i.isNeg = n.isNeg,</span></span><br><span class="line"><span class="string">    i</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">function biMultiplyByRadixPower(n, t) &#123;</span></span><br><span class="line"><span class="string">    var i = new BigInt;</span></span><br><span class="line"><span class="string">    return arrayCopy(n.digits, 0, i.digits, t, i.digits.length - t),</span></span><br><span class="line"><span class="string">    i</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">function biDivideByRadixPower(n, t) &#123;</span></span><br><span class="line"><span class="string">    var i = new BigInt;</span></span><br><span class="line"><span class="string">    return arrayCopy(n.digits, t, i.digits, 0, i.digits.length - t),</span></span><br><span class="line"><span class="string">    i</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">function biModuloByRadixPower(n, t) &#123;</span></span><br><span class="line"><span class="string">    var i = new BigInt;</span></span><br><span class="line"><span class="string">    return arrayCopy(n.digits, 0, i.digits, 0, t),</span></span><br><span class="line"><span class="string">    i</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">function biCompare(n, t) &#123;</span></span><br><span class="line"><span class="string">    if (n.isNeg != t.isNeg)</span></span><br><span class="line"><span class="string">        return 1 - 2 * Number(n.isNeg);</span></span><br><span class="line"><span class="string">    for (var i = n.digits.length - 1; i &gt;= 0; --i)</span></span><br><span class="line"><span class="string">        if (n.digits[i] != t.digits[i])</span></span><br><span class="line"><span class="string">            return n.isNeg ? 1 - 2 * Number(n.digits[i] &gt; t.digits[i]) : 1 - 2 * Number(n.digits[i] &lt; t.digits[i]);</span></span><br><span class="line"><span class="string">    return 0</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">function biDivideModulo(n, t) &#123;</span></span><br><span class="line"><span class="string">    var a = biNumBits(n), s = biNumBits(t), v = t.isNeg, r, i, u, e, h, o, f, y, p;</span></span><br><span class="line"><span class="string">    if (a &lt; s)</span></span><br><span class="line"><span class="string">        return n.isNeg ? (r = biCopy(bigOne),</span></span><br><span class="line"><span class="string">        r.isNeg = !t.isNeg,</span></span><br><span class="line"><span class="string">        n.isNeg = !1,</span></span><br><span class="line"><span class="string">        t.isNeg = !1,</span></span><br><span class="line"><span class="string">        i = biSubtract(t, n),</span></span><br><span class="line"><span class="string">        n.isNeg = !0,</span></span><br><span class="line"><span class="string">        t.isNeg = v) : (r = new BigInt,</span></span><br><span class="line"><span class="string">        i = biCopy(n)),</span></span><br><span class="line"><span class="string">        [r, i];</span></span><br><span class="line"><span class="string">    for (r = new BigInt,</span></span><br><span class="line"><span class="string">    i = n,</span></span><br><span class="line"><span class="string">    u = Math.ceil(s / bitsPerDigit) - 1,</span></span><br><span class="line"><span class="string">    e = 0; t.digits[u] &lt; biHalfRadix; )</span></span><br><span class="line"><span class="string">        t = biShiftLeft(t, 1),</span></span><br><span class="line"><span class="string">        ++e,</span></span><br><span class="line"><span class="string">        ++s,</span></span><br><span class="line"><span class="string">        u = Math.ceil(s / bitsPerDigit) - 1;</span></span><br><span class="line"><span class="string">    for (i = biShiftLeft(i, e),</span></span><br><span class="line"><span class="string">    a += e,</span></span><br><span class="line"><span class="string">    h = Math.ceil(a / bitsPerDigit) - 1,</span></span><br><span class="line"><span class="string">    o = biMultiplyByRadixPower(t, h - u); biCompare(i, o) != -1; )</span></span><br><span class="line"><span class="string">        ++r.digits[h - u],</span></span><br><span class="line"><span class="string">        i = biSubtract(i, o);</span></span><br><span class="line"><span class="string">    for (f = h; f &gt; u; --f) &#123;</span></span><br><span class="line"><span class="string">        var c = f &gt;= i.digits.length ? 0 : i.digits[f]</span></span><br><span class="line"><span class="string">          , w = f - 1 &gt;= i.digits.length ? 0 : i.digits[f - 1]</span></span><br><span class="line"><span class="string">          , b = f - 2 &gt;= i.digits.length ? 0 : i.digits[f - 2]</span></span><br><span class="line"><span class="string">          , l = u &gt;= t.digits.length ? 0 : t.digits[u]</span></span><br><span class="line"><span class="string">          , k = u - 1 &gt;= t.digits.length ? 0 : t.digits[u - 1];</span></span><br><span class="line"><span class="string">        for (r.digits[f - u - 1] = c == l ? maxDigitVal : Math.floor((c * biRadix + w) / l),</span></span><br><span class="line"><span class="string">        y = r.digits[f - u - 1] * (l * biRadix + k),</span></span><br><span class="line"><span class="string">        p = c * biRadixSquared + (w * biRadix + b); y &gt; p; )</span></span><br><span class="line"><span class="string">            --r.digits[f - u - 1],</span></span><br><span class="line"><span class="string">            y = r.digits[f - u - 1] * (l * biRadix | k),</span></span><br><span class="line"><span class="string">            p = c * biRadix * biRadix + (w * biRadix + b);</span></span><br><span class="line"><span class="string">        o = biMultiplyByRadixPower(t, f - u - 1);</span></span><br><span class="line"><span class="string">        i = biSubtract(i, biMultiplyDigit(o, r.digits[f - u - 1]));</span></span><br><span class="line"><span class="string">        i.isNeg &amp;&amp; (i = biAdd(i, o),</span></span><br><span class="line"><span class="string">        --r.digits[f - u - 1])</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    return i = biShiftRight(i, e),</span></span><br><span class="line"><span class="string">    r.isNeg = n.isNeg != v,</span></span><br><span class="line"><span class="string">    n.isNeg &amp;&amp; (r = v ? biAdd(r, bigOne) : biSubtract(r, bigOne),</span></span><br><span class="line"><span class="string">    t = biShiftRight(t, e),</span></span><br><span class="line"><span class="string">    i = biSubtract(t, i)),</span></span><br><span class="line"><span class="string">    i.digits[0] == 0 &amp;&amp; biHighIndex(i) == 0 &amp;&amp; (i.isNeg = !1),</span></span><br><span class="line"><span class="string">    [r, i]</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">function biDivide(n, t) &#123;</span></span><br><span class="line"><span class="string">    return biDivideModulo(n, t)[0]</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">function biModulo(n, t) &#123;</span></span><br><span class="line"><span class="string">    return biDivideModulo(n, t)[1]</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">function biMultiplyMod(n, t, i) &#123;</span></span><br><span class="line"><span class="string">    return biModulo(biMultiply(n, t), i)</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">function biPow(n, t) &#123;</span></span><br><span class="line"><span class="string">    for (var r = bigOne, i = n; ; ) &#123;</span></span><br><span class="line"><span class="string">        if ((t &amp; 1) != 0 &amp;&amp; (r = biMultiply(r, i)),</span></span><br><span class="line"><span class="string">        t &gt;&gt;= 1,</span></span><br><span class="line"><span class="string">        t == 0)</span></span><br><span class="line"><span class="string">            break;</span></span><br><span class="line"><span class="string">        i = biMultiply(i, i)</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    return r</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">function biPowMod(n, t, i) &#123;</span></span><br><span class="line"><span class="string">    for (var f = bigOne, u = n, r = t; ; ) &#123;</span></span><br><span class="line"><span class="string">        if ((r.digits[0] &amp; 1) != 0 &amp;&amp; (f = biMultiplyMod(f, u, i)),</span></span><br><span class="line"><span class="string">        r = biShiftRight(r, 1),</span></span><br><span class="line"><span class="string">        r.digits[0] == 0 &amp;&amp; biHighIndex(r) == 0)</span></span><br><span class="line"><span class="string">            break;</span></span><br><span class="line"><span class="string">        u = biMultiplyMod(u, u, i)</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    return f</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">function BarrettMu(n) &#123;</span></span><br><span class="line"><span class="string">    this.modulus = biCopy(n);</span></span><br><span class="line"><span class="string">    this.k = biHighIndex(this.modulus) + 1;</span></span><br><span class="line"><span class="string">    var t = new BigInt;</span></span><br><span class="line"><span class="string">    t.digits[2 * this.k] = 1;</span></span><br><span class="line"><span class="string">    this.mu = biDivide(t, this.modulus);</span></span><br><span class="line"><span class="string">    this.bkplus1 = new BigInt;</span></span><br><span class="line"><span class="string">    this.bkplus1.digits[this.k + 1] = 1;</span></span><br><span class="line"><span class="string">    this.modulo = BarrettMu_modulo;</span></span><br><span class="line"><span class="string">    this.multiplyMod = BarrettMu_multiplyMod;</span></span><br><span class="line"><span class="string">    this.powMod = BarrettMu_powMod</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">function BarrettMu_modulo(n) &#123;</span></span><br><span class="line"><span class="string">    var r = biDivideByRadixPower(n, this.k - 1), u = biMultiply(r, this.mu), f = biDivideByRadixPower(u, this.k + 1), e = biModuloByRadixPower(n, this.k + 1), o = biMultiply(f, this.modulus), s = biModuloByRadixPower(o, this.k + 1), t = biSubtract(e, s), i;</span></span><br><span class="line"><span class="string">    for (t.isNeg &amp;&amp; (t = biAdd(t, this.bkplus1)),</span></span><br><span class="line"><span class="string">    i = biCompare(t, this.modulus) &gt;= 0; i; )</span></span><br><span class="line"><span class="string">        t = biSubtract(t, this.modulus),</span></span><br><span class="line"><span class="string">        i = biCompare(t, this.modulus) &gt;= 0;</span></span><br><span class="line"><span class="string">    return t</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">function BarrettMu_multiplyMod(n, t) &#123;</span></span><br><span class="line"><span class="string">    var i = biMultiply(n, t);</span></span><br><span class="line"><span class="string">    return this.modulo(i)</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">function BarrettMu_powMod(n, t) &#123;</span></span><br><span class="line"><span class="string">    var u = new BigInt, r, i;</span></span><br><span class="line"><span class="string">    for (u.digits[0] = 1,</span></span><br><span class="line"><span class="string">    r = n,</span></span><br><span class="line"><span class="string">    i = t; ; ) &#123;</span></span><br><span class="line"><span class="string">        if ((i.digits[0] &amp; 1) != 0 &amp;&amp; (u = this.multiplyMod(u, r)),</span></span><br><span class="line"><span class="string">        i = biShiftRight(i, 1),</span></span><br><span class="line"><span class="string">        i.digits[0] == 0 &amp;&amp; biHighIndex(i) == 0)</span></span><br><span class="line"><span class="string">            break;</span></span><br><span class="line"><span class="string">        r = this.multiplyMod(r, r)</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    return u</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">function RSAKeyPair(n, t, i) &#123;</span></span><br><span class="line"><span class="string">    this.e = biFromHex(n);</span></span><br><span class="line"><span class="string">    this.d = biFromHex(t);</span></span><br><span class="line"><span class="string">    this.m = biFromHex(i);</span></span><br><span class="line"><span class="string">    this.digitSize = 2 * biHighIndex(this.m) + 2;</span></span><br><span class="line"><span class="string">    this.chunkSize = this.digitSize - 11;</span></span><br><span class="line"><span class="string">    this.radix = 16;</span></span><br><span class="line"><span class="string">    this.barrett = new BarrettMu(this.m)</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">function twoDigit(n) &#123;</span></span><br><span class="line"><span class="string">    return (n &lt; 10 ? &quot;0&quot; : &quot;&quot;) + String(n)</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">function encryptedString(n, t) &#123;</span></span><br><span class="line"><span class="string">    var e, o, s, h, c, i, f, u, v, l, y;</span></span><br><span class="line"><span class="string">    if (n.chunkSize &gt; n.digitSize - 11)</span></span><br><span class="line"><span class="string">        return &quot;Error&quot;;</span></span><br><span class="line"><span class="string">    for (var a = [], p = t.length, r = 0; r &lt; p; )</span></span><br><span class="line"><span class="string">        a[r] = t.charCodeAt(r),</span></span><br><span class="line"><span class="string">        r++;</span></span><br><span class="line"><span class="string">    for (e = a.length,</span></span><br><span class="line"><span class="string">    o = &quot;&quot;,</span></span><br><span class="line"><span class="string">    r = 0; r &lt; e; r += n.chunkSize) &#123;</span></span><br><span class="line"><span class="string">        for (c = new BigInt,</span></span><br><span class="line"><span class="string">        s = 0,</span></span><br><span class="line"><span class="string">        f = r + n.chunkSize &gt; e ? e % n.chunkSize : n.chunkSize,</span></span><br><span class="line"><span class="string">        u = [],</span></span><br><span class="line"><span class="string">        i = 0; i &lt; f; i++)</span></span><br><span class="line"><span class="string">            u[i] = a[r + f - 1 - i];</span></span><br><span class="line"><span class="string">        for (u[f] = 0,</span></span><br><span class="line"><span class="string">        v = Math.max(8, n.digitSize - 3 - f),</span></span><br><span class="line"><span class="string">        i = 0; i &lt; v; i++)</span></span><br><span class="line"><span class="string">            u[f + 1 + i] = Math.floor(Math.random() * 254) + 1;</span></span><br><span class="line"><span class="string">        for (u[n.digitSize - 2] = 2,</span></span><br><span class="line"><span class="string">        u[n.digitSize - 1] = 0,</span></span><br><span class="line"><span class="string">        h = 0; h &lt; n.digitSize; ++s)</span></span><br><span class="line"><span class="string">            c.digits[s] = u[h++],</span></span><br><span class="line"><span class="string">            c.digits[s] += u[h++] &lt;&lt; 8;</span></span><br><span class="line"><span class="string">        l = n.barrett.powMod(c, n.e);</span></span><br><span class="line"><span class="string">        y = n.radix == 16 ? biToHex(l) : biToString(l, n.radix);</span></span><br><span class="line"><span class="string">        o += y + &quot; &quot;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    return o.substring(0, o.length - 1)</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">function decryptedString(n, t) &#123;</span></span><br><span class="line"><span class="string">    for (var e = t.split(&quot; &quot;), i = &quot;&quot;, r, u, o, f = 0; f &lt; e.length; ++f)</span></span><br><span class="line"><span class="string">        for (o = n.radix == 16 ? biFromHex(e[f]) : biFromString(e[f], n.radix),</span></span><br><span class="line"><span class="string">        u = n.barrett.powMod(o, n.d),</span></span><br><span class="line"><span class="string">        r = 0; r &lt;= biHighIndex(u); ++r)</span></span><br><span class="line"><span class="string">            i += String.fromCharCode(u.digits[r] &amp; 255, u.digits[r] &gt;&gt; 8);</span></span><br><span class="line"><span class="string">    return i.charCodeAt(i.length - 1) == 0 &amp;&amp; (i = i.substring(0, i.length - 1)),</span></span><br><span class="line"><span class="string">    i</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">var biRadixBase = 2, biRadixBits = 16, bitsPerDigit = biRadixBits, biRadix = 65536, biHalfRadix = biRadix &gt;&gt;&gt; 1, biRadixSquared = biRadix * biRadix, maxDigitVal = biRadix - 1, maxInteger = 9999999999999998, maxDigits, ZERO_ARRAY, bigZero, bigOne, dpl10, lr10, hexatrigesimalToChar, hexToChar, highBitMasks, lowBitMasks;</span></span><br><span class="line"><span class="string">setMaxDigits(20);</span></span><br><span class="line"><span class="string">dpl10 = 15;</span></span><br><span class="line"><span class="string">lr10 = biFromNumber(1e15);</span></span><br><span class="line"><span class="string">hexatrigesimalToChar = [&quot;0&quot;, &quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;, &quot;7&quot;, &quot;8&quot;, &quot;9&quot;, &quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;, &quot;f&quot;, &quot;g&quot;, &quot;h&quot;, &quot;i&quot;, &quot;j&quot;, &quot;k&quot;, &quot;l&quot;, &quot;m&quot;, &quot;n&quot;, &quot;o&quot;, &quot;p&quot;, &quot;q&quot;, &quot;r&quot;, &quot;s&quot;, &quot;t&quot;, &quot;u&quot;, &quot;v&quot;, &quot;w&quot;, &quot;x&quot;, &quot;y&quot;, &quot;z&quot;];</span></span><br><span class="line"><span class="string">hexToChar = [&quot;0&quot;, &quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;, &quot;7&quot;, &quot;8&quot;, &quot;9&quot;, &quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;, &quot;f&quot;];</span></span><br><span class="line"><span class="string">highBitMasks = [0, 32768, 49152, 57344, 61440, 63488, 64512, 65024, 65280, 65408, 65472, 65504, 65520, 65528, 65532, 65534, 65535];</span></span><br><span class="line"><span class="string">lowBitMasks = [0, 1, 3, 7, 15, 31, 63, 127, 255, 511, 1023, 2047, 4095, 8191, 16383, 32767, 65535];</span></span><br><span class="line"><span class="string">setMaxDigits(129);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">function getpwd(pwd)&#123;</span></span><br><span class="line"><span class="string">    var key_to_encode = new RSAKeyPair(&quot;010001&quot;,&quot;&quot;,&quot;978C0A92D2173439707498F0944AA476B1B62595877DD6FA87F6E2AC6DCB3D0BF0B82857439C99B5091192BC134889DFF60C562EC54EFBA4FF2F9D55ADBCCEA4A2FBA80CB398ED501280A007C83AF30C3D1A142D6133C63012B90AB26AC60C898FB66EDC3192C3EC4FF66925A64003B72496099F4F09A9FB72A2CF9E4D770C41&quot;);</span></span><br><span class="line"><span class="string">    return encryptedString(key_to_encode, pwd)</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">password = <span class="string">&quot;zx******&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_encryption</span>():</span></span><br><span class="line">    encrypted_password = execjs.<span class="built_in">compile</span>(jscode).call(<span class="string">&quot;getpwd&quot;</span>, password)</span><br><span class="line">    <span class="keyword">return</span> encrypted_password</span><br><span class="line"></span><br><span class="line">get_encryption()</span><br></pre></td></tr></table></figure></li>
<li><p>Fang.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">@Description : </span></span><br><span class="line"><span class="string">@File        : Fang</span></span><br><span class="line"><span class="string">@Project     : test</span></span><br><span class="line"><span class="string">@Time        : 2022/3/8 17:57</span></span><br><span class="line"><span class="string">@Author      : LiHouJian</span></span><br><span class="line"><span class="string">@Software    : PyCharm</span></span><br><span class="line"><span class="string">@issue       : https://www1.fang.com/</span></span><br><span class="line"><span class="string">@change      : </span></span><br><span class="line"><span class="string">@reason      : </span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> scrapy</span><br><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> traceback</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> scrapy.utils <span class="keyword">import</span> request</span><br><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> etree</span><br><span class="line"><span class="keyword">from</span> scrapy.utils.project <span class="keyword">import</span> get_project_settings</span><br><span class="line"><span class="keyword">from</span> pybase.util <span class="keyword">import</span> send_file</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> get_encrypted_pwd</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;https://passport.fang.com/login.api&quot;</span></span><br><span class="line">headers = &#123;</span><br><span class="line">  <span class="string">&#x27;Connection&#x27;</span>: <span class="string">&#x27;keep-alive&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;Pragma&#x27;</span>: <span class="string">&#x27;no-cache&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;Cache-Control&#x27;</span>: <span class="string">&#x27;no-cache&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;sec-ch-ua&#x27;</span>: <span class="string">&#x27;&quot; Not A;Brand&quot;;v=&quot;99&quot;, &quot;Chromium&quot;;v=&quot;98&quot;, &quot;Google Chrome&quot;;v=&quot;98&quot;&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;Accept&#x27;</span>: <span class="string">&#x27;*/*&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded; charset=UTF-8&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;X-Requested-With&#x27;</span>: <span class="string">&#x27;XMLHttpRequest&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;sec-ch-ua-mobile&#x27;</span>: <span class="string">&#x27;?0&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;sec-ch-ua-platform&#x27;</span>: <span class="string">&#x27;&quot;Windows&quot;&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;Origin&#x27;</span>: <span class="string">&#x27;https://passport.fang.com&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;Sec-Fetch-Site&#x27;</span>: <span class="string">&#x27;same-origin&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;Sec-Fetch-Mode&#x27;</span>: <span class="string">&#x27;cors&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;Sec-Fetch-Dest&#x27;</span>: <span class="string">&#x27;empty&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;Referer&#x27;</span>: <span class="string">&#x27;https://passport.fang.com/?backurl=http%3A%2F%2Fmy.fang.com%2FAccount%2FSecuritySet.html%3Fcity%3Dbj&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;Accept-Language&#x27;</span>: <span class="string">&#x27;zh-CN,zh;q=0.9&#x27;</span>,</span><br><span class="line">  <span class="comment"># &#x27;Cookie&#x27;: &#x27;global_cookie=oe8q9avuq3j9tlztoytsdel5m19l0hvqfxu; __jsluid_s=799d58c84f2792a88df18cb929fdff1c; g_sourcepage=txz_dl%5Egg_pc; __utmc=147393320; __utma=147393320.1290564514.1646728721.1646730819.1646735182.3; __utmz=147393320.1646735182.3.3.utmcsr=www1.fang.com|utmccn=(referral)|utmcmd=referral|utmcct=/; __utmt_t0=1; __utmt_t1=1; city=bj; token=57848a3bb7c4466499b350c5229495b4; unique_cookie=U_oe8q9avuq3j9tlztoytsdel5m19l0hvqfxu*14; __utmb=147393320.4.10.1646735182&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">pay_load = &#123;</span><br><span class="line">	<span class="string">&#x27;uid&#x27;</span>: <span class="string">&#x27;18979****&#x27;</span>,</span><br><span class="line">	<span class="string">&#x27;pwd&#x27;</span>: get_encrypted_pwd.get_encryption(),</span><br><span class="line">	<span class="string">&#x27;Service&#x27;</span>: <span class="string">&#x27;soufun-passport-web&#x27;</span>,</span><br><span class="line">	<span class="string">&#x27;AutoLogin&#x27;</span>: <span class="string">&#x27;1&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">req = requests.post(url=url, headers=headers, data=pay_load)</span><br><span class="line"><span class="built_in">print</span>(req)</span><br></pre></td></tr></table></figure></li>
</ul>
<p>运行效果:</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/bgRC90"><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://s1.ax1x.com/2022/03/08/bgRC90.png"
                      alt="bgRC90.png"
                ></a></p>

        </div>

        
            <div class="post-copyright-info">
                <div class="article-copyright-info-container">
    <ul>
        <li>Post title：JS逆向登录房天下</li>
        <li>Post author：Lhj</li>
        <li>Create time：2022-03-08 17:18:30</li>
        <li>
            Post link：https://keep.xpoet.cn/2022/03/08/JS逆向登录房天下/
        </li>
        <li>
            Copyright Notice：All articles in this blog are licensed under <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">BY-NC-SA</a> unless stating additionally.
        </li>
    </ul>
</div>

            </div>
        

        

        
            <div class="article-nav">
                
                    <div class="article-prev">
                        <a class="prev"
                           rel="prev"
                           href="/2022/03/09/Tabby%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/"
                        >
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                            <span class="title flex-center">
                                <span class="post-nav-title-item">Tabby的基本使用</span>
                                <span class="post-nav-item">Prev posts</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next">
                        <a class="next"
                           rel="next"
                           href="/2022/03/08/%E5%AD%97%E8%8A%82%E6%8A%96%E9%9F%B3%E5%90%8E%E7%AB%AF%E6%97%A5%E5%B8%B8%E5%AE%9E%E4%B9%A0%E4%B8%80%E9%9D%A2%E9%9D%A2%E7%BB%8F(%E9%83%A8%E5%88%86)/"
                        >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">字节抖音后端日常实习一面面经(部分)</span>
                                <span class="post-nav-item">Next posts</span>
                            </span>
                            <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        

        
            <div class="comment-container">
                <div class="comments-container">
    <div id="comment-anchor"></div>
    <div class="comment-area-title">
        <i class="fas fa-comments">&nbsp;Comments</i>
    </div>
    

        
            
    <div class="valine-container">
        <script data-pjax
                src="//cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"></script>
        <div id="vcomments"></div>
        <script data-pjax>
            function loadValine() {
                new Valine({
                    el: '#vcomments',
                    appId: 'nIcO1O6cSVuRH8EROCWwNFWN-gzGzoHsz',
                    appKey: 'qrglokTeum8DXiYRzM4k4NF4',
                    meta: ['nick', 'mail', 'link'],
                    avatar: 'wavatar',
                    enableQQ: true,
                    placeholder: '😜 尽情吐槽吧~',
                    lang: 'en'.toLowerCase()
                });

                function getAuthor(language) {
                    switch (language) {
                        case 'en':
                            return 'Author';
                        case 'zh-CN':
                            return '博主';
                        default:
                            return 'Master';
                    }
                }

                // Add "Author" identify
                const getValineDomTimer = setInterval(() => {
                    const vcards = document.querySelectorAll('#vcomments .vcards .vcard');
                    if (vcards.length > 0) {
                        let author = 'Lhj';

                        if (author) {
                            for (let vcard of vcards) {
                                const vnick_dom = vcard.querySelector('.vhead .vnick');
                                const vnick = vnick_dom.innerHTML;
                                if (vnick === author) {
                                    vnick_dom.innerHTML = `${vnick} <span class="author">${getAuthor(KEEP.hexo_config.language)}</span>`
                                }
                            }
                        }
                        clearInterval(getValineDomTimer);
                    } else {
                        clearInterval(getValineDomTimer);
                    }
                }, 2000);
            }

            if ('true') {
                const loadValineTimeout = setTimeout(() => {
                    loadValine();
                    clearTimeout(loadValineTimeout);
                }, 1000);
            } else {
                window.addEventListener('DOMContentLoaded', loadValine);
            }
        </script>
    </div>



        
    
</div>

            </div>
        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
              <span>2020</span>
              -
            
            2022&nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;<a href="/">Lhj</a>
        </div>
        
            <script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    <span id="busuanzi_container_site_uv">
                        Visitor Count&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp;
                    </span>
                
                
                    <span id="busuanzi_container_site_pv">
                        Totalview&nbsp;<span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="theme-info info-item">
            Powered by <a target="_blank" href="https://hexo.io">Hexo</a>&nbsp;|&nbsp;Theme&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.4.5</a>
        </div>
        
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item page-aside-toggle">
                <i class="fas fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
            <li class="go-comment">
                <i class="fas fa-comment"></i>
            </li>
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        $tools-item-width = 32px;
$tools-item-font-size = 1.1rem;
$tools-item-border-radius = 1px;


.side-tools-container {
  position: relative;

  .tools-item {
    width: $tools-item-width;
    height: $tools-item-width;
    font-size: $tools-item-font-size;
    margin-bottom: 3px;
    cursor: pointer;
    border-right: none;
    border-radius: $tools-item-border-radius;
    box-shadow: 1px 1px 3px var(--shadow-color);
    color: var(--default-text-color);
    background: var(--background-color);

    i {
      color: var(--default-text-color);
    }

    &:hover {
      color: var(--background-color);
      background: var(--primary-color);
      box-shadow: 2px 2px 6px var(--shadow-color);

      i {
        color: var(--background-color);
      }
    }

    +keep-tablet() {
      width: $tools-item-width * 0.9;
      height: $tools-item-width * 0.9;
      font-size: $tools-item-font-size * 0.9;
      margin-bottom: 2px;
    }

    &.rss {

      a {
        border-radius: $tools-item-border-radius;
        width: 100%;
        height: 100%;

        &:hover {
          color: var(--background-color);
          background: var(--primary-color);
          box-shadow: 2px 2px 6px var(--shadow-color);
        }
      }
    }
  }


  .side-tools-list {
    opacity: 0;
    transform: translateX(100%);
    transition-t("transform, opacity", "0, 0", "0.2, 0.2", "linear, linear");

    .tool-expand-width {
      +keep-tablet() {
        display: none;
      }
    }


    &.show {
      opacity: 1;
      transform: translateX(0);
    }
  }


  .exposed-tools-list {

    if (hexo-config('style.scroll.percent.enable') == true) {
      .tool-scroll-to-top {
        display: none;

        &.show {
          display: flex;
        }

        &:hover {

          .percent {
            display: none;
          }

          .arrow-up {
            display: flex;
          }

        }

        .arrow-up {
          display: none;
        }

        .percent {
          display: flex;
          font-size: 1rem;
        }

      }

    }
  }
}

    </div>

    
        <aside class="page-aside">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E6%9E%90"><span class="nav-number">1.</span> <span class="nav-text">分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Python%E6%A8%A1%E6%8B%9F%E6%89%A7%E8%A1%8C"><span class="nav-number">2.</span> <span class="nav-text">Python模拟执行</span></a></li></ol>
    </div>
</div>
        </aside>
    

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="Search..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>



<script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/utils.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/main.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/header-shrink.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/back2top.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/dark-light-toggle.js"></script>


    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/local-search.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/code-copy.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/lazyload.js"></script>


<div class="post-scripts pjax">
    
        <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/left-side-toggle.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/libs/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/toc.js"></script>
    
</div>


    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/libs/pjax.min.js"></script>
<script>
    window.addEventListener('DOMContentLoaded', () => {
        window.pjax = new Pjax({
            selectors: [
                'head title',
                '.page-container',
                '.pjax'
            ],
            history: true,
            debug: false,
            cacheBust: false,
            timeout: 0,
            analytics: false,
            currentUrlFullReload: false,
            scrollRestoration: false,
            // scrollTo: true,
        });

        document.addEventListener('pjax:send', () => {
            KEEP.utils.pjaxProgressBarStart();
        });

        document.addEventListener('pjax:complete', () => {
            KEEP.utils.pjaxProgressBarEnd();
            window.pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
            KEEP.refresh();
        });
    });
</script>



</body>
</html>
