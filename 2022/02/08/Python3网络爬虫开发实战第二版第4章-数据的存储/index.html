<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="Hexo Theme Keep">
    <meta name="author" content="Lhj">
    
    <title>
        
            Python3网络爬虫开发实战第二版第4章-数据的存储 |
        
        Alexander
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="/images/logo.svg">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/css/font-awesome.min.css">
    <script id="hexo-configurations">
    let KEEP = window.KEEP || {};
    KEEP.hexo_config = {"hostname":"example.com","root":"/","language":"en","path":"search.json"};
    KEEP.theme_config = {"toc":{"enable":true,"number":true,"expand_all":true,"init_open":true},"style":{"primary_color":"#0066CC","avatar":"/images/avatar.svg","favicon":"/images/logo.svg","article_img_align":"left","left_side_width":"260px","content_max_width":"920px","hover":{"shadow":false,"scale":false},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":"Keep writing and Keep loving."},"scroll":{"progress_bar":{"enable":true},"percent":{"enable":true}}},"local_search":{"enable":true,"preload":false},"code_copy":{"enable":true,"style":"default"},"pjax":{"enable":true},"lazyload":{"enable":true},"version":"3.4.5"};
    KEEP.language_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
  </script>
<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
</head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
        <span class="pjax-progress-bar"></span>
        <span class="pjax-progress-icon">
            <i class="fas fa-circle-notch fa-spin"></i>
        </span>
    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
            <a class="logo-title" href="/">
                Alexander
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                NOTE
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                ARCHIVES
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/about"
                            >
                                ABOUT
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">NOTE</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">ARCHIVES</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/about">ABOUT</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="article-content-container">

        <div class="article-title">
            <span class="title-hover-animation">Python3网络爬虫开发实战第二版第4章-数据的存储</span>
        </div>

        
            <div class="article-header">
                <div class="avatar">
                    <img src="/images/avatar.svg">
                </div>
                <div class="info">
                    <div class="author">
                        <span class="name">Lhj</span>
                        
                            <span class="author-label">Lv6</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fas fa-edit"></i>&nbsp;
        <span class="pc">2022-02-08 09:27:30</span>
        <span class="mobile">2022-02-08 09:27</span>
    </span>
    
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fas fa-file-word"></i>&nbsp;<span>3.2k Words</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fas fa-clock"></i>&nbsp;<span>13 Mins</span>
        </span>
    
    
        <span class="article-pv article-meta-item">
            <i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                    </div>
                </div>
            </div>
        

        <div class="article-content markdown-body">
            <h3 id="TXT文本文件存储"><a href="#TXT文本文件存储" class="headerlink" title="TXT文本文件存储"></a>TXT文本文件存储</h3><p>以txt格式存储</p>
<p>r: 以只读打开</p>
<p>rb: 以二进制只读方式打开</p>
<p>r+: 以读写方式打开</p>
<p>rb+: 以二进制读写方式打开</p>
<p>w: 以写入方式打开</p>
<p>wb: 以二进制写入方式打开</p>
<p>w+: 以读写方式打开</p>
<p>wb+: 以二进制读写方式打开</p>
<p>a: 以追加方式打开一个文件</p>
<p>ab: 以二进制追加方式打开一个文件</p>
<p>ab+: 以二进制追加方式打开一个文件，如果该文件不存在就新建一个文件用于读写</p>
<h3 id="JSON文件存储"><a href="#JSON文件存储" class="headerlink" title="JSON文件存储"></a>JSON文件存储</h3><p>在js中，一切皆对象，对象在js中是指用花括号{}包围起来的内容，数据结构是{key1: value1, key2: value2}这种键值对结构，key表示对象的属性，value表示属性的值，前者可以使用整数和字符串，后者可以是任意类型</p>
<p>关于Python的json文件存储以及提取可以参考<a class="link"   target="_blank" rel="noopener" href="https://www.cnblogs.com/guguobao/p/9512696.html" >这里<i class="fas fa-external-link-alt"></i></a></p>
<h3 id="CSV文件存储"><a href="#CSV文件存储" class="headerlink" title="CSV文件存储"></a>CSV文件存储</h3><p>详情请见: <a class="link"   target="_blank" rel="noopener" href="https://www.cnblogs.com/gdjlc/p/11406599.html" >https://www.cnblogs.com/gdjlc/p/11406599.html<i class="fas fa-external-link-alt"></i></a></p>
<p>还可以参照书本</p>
<h3 id="MySQL数据存储"><a href="#MySQL数据存储" class="headerlink" title="MySQL数据存储"></a>MySQL数据存储</h3><p>详情请见: <a class="link"   target="_blank" rel="noopener" href="https://www.cnblogs.com/hanfanfan/p/10398244.html" >https://www.cnblogs.com/hanfanfan/p/10398244.html<i class="fas fa-external-link-alt"></i></a></p>
<h3 id="MongoDB数据存储"><a href="#MongoDB数据存储" class="headerlink" title="MongoDB数据存储"></a>MongoDB数据存储</h3><p>NoSQL，全称为Not Only SQL，意为不仅仅是SQL，泛指菲关系型数据库，NoSQL是基于键值对的，而且不需要经过SQL层的解析，数据之间没有耦合性，性能非常高</p>
<p>非关系型数据库又可细分如下:</p>
<ul>
<li>键值存储数据库: 代表有Redis等</li>
<li>列存储数据库: 代表有Cassandra，HBase和Riak等</li>
<li>文档型数据库: 代表有CouchDB和MongoDB等</li>
<li>图形数据库: 代表有Neo4j，InfoGrid等</li>
</ul>
<p>我们爬虫使用非关系型数据库是比较方便的，我们来看看MongoDB:</p>
<h4 id="安装MongoDB"><a href="#安装MongoDB" class="headerlink" title="安装MongoDB"></a>安装MongoDB</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install MongoDB</span><br></pre></td></tr></table></figure>

<h4 id="连接MongoDB"><a href="#连接MongoDB" class="headerlink" title="连接MongoDB"></a>连接MongoDB</h4><p>连接MongoDB，需要使用PyMongo库里面的MongoClient方法，一般而言，传入MongoDB的IP以及端口即可，MongoClient方法的第一个参数为地址host，第二个参数为端口port(如果不传入此参数默认为27017)</p>
<p>示例如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymongo</span><br><span class="line">client = pymongo.MongoClient(host=<span class="string">&#x27;localhost&#x27;</span>, port=<span class="number">27017</span>)</span><br></pre></td></tr></table></figure>

<p>上面的client就是MongoDB的连接对象了</p>
<p>另外，还可以直接给MongoDB的第一个参数传入MongoDB的连接字符串，它以mongodb开头，实例如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymongo</span><br><span class="line">client = pymongo.MongoClient(host=<span class="string">&#x27;mongodb://localhost:27017&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="创建数据库"><a href="#创建数据库" class="headerlink" title="创建数据库"></a>创建数据库</h4><p>示例如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymongo</span><br><span class="line"> </span><br><span class="line">myclient = pymongo.MongoClient(<span class="string">&quot;mongodb://localhost:27017/&quot;</span>)</span><br><span class="line">mydb = myclient[<span class="string">&quot;runoobdb&quot;</span>]</span><br></pre></td></tr></table></figure>

<p>执行以上代码便创建了一个名叫runoobdb的数据库，但是要注意在MongoDB中数据库只有在内容插入后才会创建! 就是说，数据库创建后要创建集合(数据表)并插入一个文档(记录)，数据库才会真正创建</p>
<h4 id="创建集合"><a href="#创建集合" class="headerlink" title="创建集合"></a>创建集合</h4><p>示例如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">myclient = pymongo.MongoClient(<span class="string">&quot;mongodb://localhost:27017/&quot;</span>)</span><br><span class="line">mydb = myclient[<span class="string">&quot;runoobdb&quot;</span>]</span><br><span class="line"> </span><br><span class="line">mycol = mydb[<span class="string">&quot;sites&quot;</span>]</span><br></pre></td></tr></table></figure>

<p>执行以上代码便创建了一个名叫sites的集合，但是要注意在 MongoDB 中，集合只有在内容插入后才会创建! 就是说，创建集合(数据表)后要再插入一个文档(记录)，集合才会真正创建</p>
<h4 id="指定数据库"><a href="#指定数据库" class="headerlink" title="指定数据库"></a>指定数据库</h4><p>示例如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db = client.test</span><br></pre></td></tr></table></figure>

<p>这里调用client的test属性即可返回test数据库，当然也可以这样指定:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db = client[&#x27;test&#x27;]</span><br></pre></td></tr></table></figure>

<p>以上两种方式是等价的</p>
<h4 id="指定集合"><a href="#指定集合" class="headerlink" title="指定集合"></a>指定集合</h4><p>MongoDB下又包含多个集合，这些结合类似于关系型数据库的表</p>
<p>示例如下:(这里指定一个集合为students)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">collection = db.students</span><br></pre></td></tr></table></figure>

<p>或者:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">collection = [<span class="string">&#x27;students&#x27;</span>]</span><br></pre></td></tr></table></figure>

<h4 id="插入数据"><a href="#插入数据" class="headerlink" title="插入数据"></a>插入数据</h4><p>我们在students这个集合中试着插入一个数据，这个数据以字典形式表示:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymongo</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">myclient = pymongo.MongoClient(<span class="string">&quot;mongodb://localhost:27017/&quot;</span>)</span><br><span class="line">mydb = myclient[<span class="string">&quot;runoobdb&quot;</span>]</span><br><span class="line">mycol = mydb[<span class="string">&#x27;students&#x27;</span>]</span><br><span class="line"></span><br><span class="line">studnet = &#123;</span><br><span class="line">	<span class="string">&quot;name&quot;</span>: <span class="string">&quot;jkl&quot;</span>,</span><br><span class="line">	<span class="string">&quot;age&quot;</span>: <span class="string">&quot;45&quot;</span>,</span><br><span class="line">	<span class="string">&quot;gender&quot;</span>: <span class="string">&quot;man&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">rsult = mycol.insert(studnet)  <span class="comment"># insert is deprecated(insert方法被弃用)</span></span><br><span class="line"><span class="built_in">print</span>(rsult)  <span class="comment"># 会返回一个ObjectId类型的_id属性，执行insert方法后会返回_id值</span></span><br></pre></td></tr></table></figure>

<p>当然我们也可以插入多条数据，用列表形式传递即可:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymongo</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">myclient = pymongo.MongoClient(<span class="string">&quot;mongodb://localhost:27017/&quot;</span>)</span><br><span class="line">mydb = myclient[<span class="string">&quot;runoobdb&quot;</span>]</span><br><span class="line">mycol = mydb[<span class="string">&#x27;students&#x27;</span>]</span><br><span class="line"></span><br><span class="line">studnet1 = &#123;</span><br><span class="line">	<span class="string">&quot;name&quot;</span>: <span class="string">&quot;jkl&quot;</span>,</span><br><span class="line">	<span class="string">&quot;age&quot;</span>: <span class="string">&quot;45&quot;</span>,</span><br><span class="line">	<span class="string">&quot;gender&quot;</span>: <span class="string">&quot;man&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">studnet2 = &#123;</span><br><span class="line">	<span class="string">&quot;name&quot;</span>: <span class="string">&quot;jklg&quot;</span>,</span><br><span class="line">	<span class="string">&quot;age&quot;</span>: <span class="string">&quot;453&quot;</span>,</span><br><span class="line">	<span class="string">&quot;gender&quot;</span>: <span class="string">&quot;women&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">rsult = mycol.insert([studnet1,studnet2])  <span class="comment"># insert is deprecated(insert方法被弃用)</span></span><br><span class="line"><span class="built_in">print</span>(rsult)  <span class="comment"># 会返回一个ObjectId类型的_id属性，执行insert方法后会返回_id值</span></span><br><span class="line"><span class="comment"># 插入多个将会返回_id的列表</span></span><br></pre></td></tr></table></figure>

<p>虽然在Python3.x中insert方法已经不被官方所推荐，但还是可以继续使用，官方推荐用insert_one插入一个，用insert_many插入多个:</p>
<p>示例如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymongo</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">myclient = pymongo.MongoClient(<span class="string">&quot;mongodb://localhost:27017/&quot;</span>)</span><br><span class="line">mydb = myclient[<span class="string">&quot;runoobdb&quot;</span>]</span><br><span class="line">mycol = mydb[<span class="string">&#x27;students&#x27;</span>]</span><br><span class="line"></span><br><span class="line">studnet1 = &#123;</span><br><span class="line">	<span class="string">&quot;name&quot;</span>: <span class="string">&quot;jkvl&quot;</span>,</span><br><span class="line">	<span class="string">&quot;age&quot;</span>: <span class="string">&quot;45&quot;</span>,</span><br><span class="line">	<span class="string">&quot;gender&quot;</span>: <span class="string">&quot;man&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">result = mycol.insert_one(studnet1)  <span class="comment"># 官方推荐使用insert_one</span></span><br><span class="line"><span class="built_in">print</span>(result)  <span class="comment"># 返回这次返回的是InsertOneResult对象，我们可以调用其inserted_id属性获取_id</span></span><br><span class="line"><span class="built_in">print</span>(result.inserted_id)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymongo</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">myclient = pymongo.MongoClient(<span class="string">&quot;mongodb://localhost:27017/&quot;</span>)</span><br><span class="line">mydb = myclient[<span class="string">&quot;runoobdb&quot;</span>]</span><br><span class="line">mycol = mydb[<span class="string">&#x27;students&#x27;</span>]</span><br><span class="line"></span><br><span class="line">studnet1 = &#123;</span><br><span class="line">	<span class="string">&quot;name&quot;</span>: <span class="string">&quot;jokvl&quot;</span>,</span><br><span class="line">	<span class="string">&quot;age&quot;</span>: <span class="string">&quot;45&quot;</span>,</span><br><span class="line">	<span class="string">&quot;gender&quot;</span>: <span class="string">&quot;man&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">studnet2 = &#123;</span><br><span class="line">	<span class="string">&quot;name&quot;</span>: <span class="string">&quot;jlkvl&quot;</span>,</span><br><span class="line">	<span class="string">&quot;age&quot;</span>: <span class="string">&quot;445&quot;</span>,</span><br><span class="line">	<span class="string">&quot;gender&quot;</span>: <span class="string">&quot;man&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">result = mycol.insert_many([studnet1, studnet2])  <span class="comment"># 官方推荐使用insert_many</span></span><br><span class="line"><span class="built_in">print</span>(result)  <span class="comment"># 返回这次返回的是InsertOneResult对象，我们可以调用其inserted_ids属性获取_id</span></span><br><span class="line"><span class="built_in">print</span>(result.inserted_ids)</span><br></pre></td></tr></table></figure>

<h4 id="查询"><a href="#查询" class="headerlink" title="查询"></a>查询</h4><p>我们可以使用find_one或find方法进行查询，前者查询得到的是单个结果，后者则会返回一个生成器对象</p>
<p>示例如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymongo</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">myclient = pymongo.MongoClient(<span class="string">&quot;mongodb://localhost:27017/&quot;</span>)</span><br><span class="line">mydb = myclient[<span class="string">&quot;runoobdb&quot;</span>]</span><br><span class="line">mycol = mydb[<span class="string">&#x27;students&#x27;</span>]</span><br><span class="line">result = mycol.find_one(&#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;jokvl&#x27;</span>&#125;)  <span class="comment"># 字典类型</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(result))</span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure>

<p>我们还可以根据ObjectId来查询数据，需要用到bson库里的objectid:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymongo</span><br><span class="line"><span class="keyword">from</span> bson.objectid <span class="keyword">import</span> ObjectId</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">myclient = pymongo.MongoClient(<span class="string">&quot;mongodb://localhost:27017/&quot;</span>)</span><br><span class="line">mydb = myclient[<span class="string">&quot;runoobdb&quot;</span>]</span><br><span class="line">mycol = mydb[<span class="string">&#x27;students&#x27;</span>]</span><br><span class="line">result = mycol.find_one(&#123;<span class="string">&#x27;_id&#x27;</span>: ObjectId(<span class="string">&#x27;6201e6be4652abcba2496717&#x27;</span>)&#125;)  <span class="comment"># 字典类型</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(result))</span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure>

<p>如果查询结果不存在，就会返回None</p>
<p>查询多条数据，可以使用find方法:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">result = collection.find(<span class="string">&#x27;age&#x27;</span>: <span class="number">20</span>)</span><br><span class="line"><span class="keyword">for</span> r <span class="keyword">in</span> result:</span><br><span class="line">   	<span class="built_in">print</span>(r)</span><br></pre></td></tr></table></figure>

<p>如果要查询age大于20的数据，写法如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">result = collection.find(&#123;<span class="string">&#x27;age&#x27;</span>: &#123;<span class="string">&#x27;$gt&#x27;</span>: <span class="number">20</span>&#125;&#125;)</span><br></pre></td></tr></table></figure>

<p>比较符号如下:</p>
<table>
<thead>
<tr>
<th>符号</th>
<th>含义</th>
<th>实例</th>
</tr>
</thead>
<tbody><tr>
<td>$lt</td>
<td>小于</td>
<td>{‘age’: {‘$lt’: 20}}</td>
</tr>
<tr>
<td>$gt</td>
<td>大于</td>
<td>{‘age’: {‘$gt’: 20}}</td>
</tr>
<tr>
<td>$lte</td>
<td>小于等于</td>
<td>{‘age’: {‘$lte’: 20}}</td>
</tr>
<tr>
<td>$gte</td>
<td>大于等于</td>
<td>{‘age’: {‘$gte’: 20}}</td>
</tr>
<tr>
<td>$ne</td>
<td>不等于</td>
<td>{‘age’: {‘$ne’: 20}}</td>
</tr>
<tr>
<td>$in</td>
<td>在范围内</td>
<td>{‘age’: {‘$in’: [20, 30]}}</td>
</tr>
<tr>
<td>$nin</td>
<td>不在范围内</td>
<td>{‘age’: {‘$nin’: [20, 30]}}</td>
</tr>
</tbody></table>
<p>另外还可以使用正则表达式进行匹配，比如下面查询name以M为开头的学生数量:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">result = collection.find(&#123;<span class="string">&#x27;name&#x27;</span>: &#123;<span class="string">&#x27;$regex&#x27;</span>: <span class="string">&#x27;^M.*&#x27;</span>&#125;&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="计数"><a href="#计数" class="headerlink" title="计数"></a>计数</h4><p>使用count方法来计数:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">count = collection.find().count()</span><br></pre></td></tr></table></figure>

<p>统计符合条件的个数:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">count = collection.find(&#123;<span class="string">&#x27;age&#x27;</span>: <span class="number">20</span>&#125;).count()</span><br></pre></td></tr></table></figure>

<p>运行结果都是一个数值</p>
<h4 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h4><p>使用sort方法，并传入排序的字段及升降序标准即可:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">result = collection.find().sort(<span class="string">&#x27;name&#x27;</span>, pymongo.ASCENDING)</span><br><span class="line"><span class="built_in">print</span>([result[<span class="string">&#x27;name&#x27;</span>] <span class="keyword">for</span> result <span class="keyword">in</span> results])</span><br></pre></td></tr></table></figure>

<p>以上代码中的ASCENDING表示升序排序，降序排序可传入pymongo.DESCENDING</p>
<h4 id="偏移"><a href="#偏移" class="headerlink" title="偏移"></a>偏移</h4><p>在某些情况下，我们可能只想取某几个元素，这时候我们可以利用skip方法偏移几个位置:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">result = collection.find().sort(<span class="string">&#x27;name&#x27;</span>, pymongo.ASCENDING).skip(<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>([result[<span class="string">&#x27;name&#x27;</span>] <span class="keyword">for</span> result <span class="keyword">in</span> results])</span><br></pre></td></tr></table></figure>

<p>还可以使用limit方法指定要获取的结果个数:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">result = collection.find().sort(<span class="string">&#x27;name&#x27;</span>, pymongo.ASCENDING).skip(<span class="number">2</span>).limit(<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>([result[<span class="string">&#x27;name&#x27;</span>] <span class="keyword">for</span> result <span class="keyword">in</span> results])</span><br></pre></td></tr></table></figure>

<p>注意: 在数据库中数量非常庞大的时候，比如千万、亿级别的，最好不要使用大偏移量来查询数据，因为这样很可能导致内存溢出，这个时候可以采用以ObjectId的方法来查询</p>
<h4 id="更新"><a href="#更新" class="headerlink" title="更新"></a>更新</h4><p>对于数据更新，我们可以使用update方法，在其中指定更新的条件和更新后的数据即可，实例如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">condition = &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;Kevin&#x27;</span>&#125;</span><br><span class="line">student = collection.find_one(condition)</span><br><span class="line">student[<span class="string">&#x27;age&#x27;</span>] = <span class="number">25</span></span><br><span class="line">result = collection.update(condition, student)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure>

<p>执行以上语句会返回成功或者失败和影响数据的条数(nMdified)</p>
<p>对比以上代码，我们还可以使用$set操作符实现数据更新，实例如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">result = collection.update(condition, &#123;<span class="string">&#x27;$set&#x27;</span>: student&#125;)</span><br></pre></td></tr></table></figure>

<p>这样可以只更新student字典内存在的字段，如果原先还有其他字段，是不会动的，不会被更新，也不会删除；而如果用update，就会把之前的数据全部用student字典替换，要是存在其他字段，会被删除</p>
<p>官方推荐使用update_one和update_many方法来处理单条和多条数据更新过程，它们的用法更为严格，第二个参数都需要使用$类型操作符作为字典的键名，实例代码如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">condition = &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;Kevin&#x27;</span>&#125;</span><br><span class="line">student = collection.find_one(condition)</span><br><span class="line">student[<span class="string">&#x27;age&#x27;</span>] = <span class="number">26</span></span><br><span class="line">result = collection.update_one(condition, &#123;<span class="string">&#x27;$set&#x27;</span>: student&#125;)</span><br><span class="line"><span class="built_in">print</span>(result)  <span class="comment"># UpdateResult类型</span></span><br><span class="line"><span class="built_in">print</span>(result.matched_count, result.modified_count)  <span class="comment"># 匹配的数据条目和影响的数据条目</span></span><br></pre></td></tr></table></figure>

<p>我们在来看一个例子:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">condition = &#123;<span class="string">&#x27;age&#x27;</span>: &#123;<span class="string">&#x27;$gt&#x27;</span>: <span class="number">20</span>&#125;&#125;</span><br><span class="line">result = collection.update_one(condition, &#123;<span class="string">&#x27;$inc&#x27;</span>: &#123;<span class="string">&#x27;age&#x27;</span>: <span class="number">1</span>&#125;&#125;)  <span class="comment"># 对age+1对第一条符合的做出改变，如果用update_many就会更新所有被选中的</span></span><br><span class="line"><span class="built_in">print</span>(result)  <span class="comment"># UpdateResult类型</span></span><br><span class="line"><span class="built_in">print</span>(result.matched_count, result.modified_count)  <span class="comment"># 匹配的数据条目和影响的数据条目</span></span><br></pre></td></tr></table></figure>

<h4 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h4><p>删除操作比较简单，直接调用remove方法并指定删除条件即可，实例代码如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">result = collection.remove(&#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;kevin&#x27;</span>&#125;)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure>

<p>运行结果如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&#x27;ok&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;n&#x27;</span>: <span class="number">1</span>&#125;</span><br></pre></td></tr></table></figure>

<p>这里依然有两个新方法，delete_one和delete_many，delete_one就是删除第一符合条件的数据，delete_many就是删除所有符合条件的数据:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">result = collection.delete_one(&#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;kevin&#x27;</span>&#125;)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;result&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(result.deleted_count)  <span class="comment"># 1</span></span><br><span class="line">result = collection.delete_many(&#123;<span class="string">&#x27;age&#x27;</span>: &#123;<span class="string">&#x27;$lt&#x27;</span>: <span class="number">25</span>&#125;&#125;)</span><br><span class="line"><span class="built_in">print</span>(result.deleted_count)  <span class="comment"># 4</span></span><br></pre></td></tr></table></figure>

<p>两个方法返回的结果都是DeletedResult类型，可以调用deleted_coun属性获取删除的数量</p>
<h4 id="其它操作"><a href="#其它操作" class="headerlink" title="其它操作"></a>其它操作</h4><p>PyMongo还提供了一些组合方法:</p>
<p>find_one_and_delete: 查找后删除</p>
<p>find_one_and_raplace: 查找后替换</p>
<p>find_one_and_update: 查找后更新</p>
<h3 id="Redi缓存存储"><a href="#Redi缓存存储" class="headerlink" title="Redi缓存存储"></a>Redi缓存存储</h3><p>Redis是一个基于内存的、高效的键值型非关系型数据库，存取效率极高，而且支持多种数据存储结构，使用起来也非常简单，下面我们来看看:</p>
<h4 id="安装Redis"><a href="#安装Redis" class="headerlink" title="安装Redis"></a>安装Redis</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install redis</span><br></pre></td></tr></table></figure>

<p>以上就是安装了redis-py库，即用来操作Redis的Python包</p>
<h5 id="Redis和StrictRedis"><a href="#Redis和StrictRedis" class="headerlink" title="Redis和StrictRedis"></a>Redis和StrictRedis</h5><p>StrictRedis类实现了绝大部分官方的Redis命令，参数也一一对应，例如set方法就对应着Redis命令的set方法，而Redis是StrictRedis的子类，其主要功能是向后兼容旧版本库里的几个方法；为了实现兼容，Redis类对方法做了改写，例如将lrem方法中的value和num参数的位置进行了互换，这和Redis命令行参数是不一样的，官方推荐使用StrictRedis！</p>
<h4 id="连接Redis"><a href="#连接Redis" class="headerlink" title="连接Redis"></a>连接Redis</h4><p>首先我们需要启动redis服务，步骤如下:</p>
<p>首先申明，我是在一个工作电脑上</p>
<ul>
<li><p>打开everything，然后搜索redis，进入到redis的安装目录:</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/stormwasd/image-hosting@master/20220208/Snipaste_2022-02-08_16-13-31.61m7f9fmij00.webp"
                      alt="Snipaste_2022-02-08_16-13-31"
                ></p>
<p>然后在此路径打开cmd，输入以下命令:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-server.exe</span><br></pre></td></tr></table></figure>

<p>以上命令只能启动6379端口，用以下命令可以在7000端口启动redis</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">  redis-server.exe redis.windows7000.conf</span><br><span class="line"></span><br><span class="line">​		然后就启动了redis</span><br><span class="line"></span><br><span class="line">接下来我们进行连接并测试:</span><br><span class="line"></span><br><span class="line">```python</span><br><span class="line"><span class="keyword">from</span> redis <span class="keyword">import</span> StrictRedis</span><br><span class="line"></span><br><span class="line">redis = StrictRedis(host=<span class="string">&#x27;localhost&#x27;</span>, port=<span class="number">6379</span>, db=<span class="number">0</span>, password=<span class="literal">None</span>)  <span class="comment"># 没有设置password就None吧</span></span><br><span class="line">redis.<span class="built_in">set</span>(<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;Bob&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(redis.get(<span class="string">&#x27;name&#x27;</span>))</span><br></pre></td></tr></table></figure></li>
</ul>
<p>运行结果如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">b&#x27;Bob&#x27;</span></span><br></pre></td></tr></table></figure>

<p>以上代码我们传入了Redis的地址，运行端口，使用的数据库和密码信息，在默认不传数据的情况下这4个参数分别为localhost，6379,0和None</p>
<p>以上代码同时说明我们已经成功连接redis，当然我们也可使用ConnectionPool来连接Redis，实例如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> redis <span class="keyword">import</span> StrictRedis, ConnectionPool</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pool = ConnectionPool(host=<span class="string">&#x27;localhost&#x27;</span>, port=<span class="number">6379</span>, db=<span class="number">0</span>, password=<span class="literal">None</span>)</span><br><span class="line">redis = StrictRedis(connection_pool=pool)</span><br><span class="line">redis.<span class="built_in">set</span>(<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;tob&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(redis.get(<span class="string">&#x27;name&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p>另外，ConnectionPool还支持通过URL来构建，URL支持的格式有如下3中:</p>
<p>redis://[:password]@host:port/db</p>
<p>rediss://[:password]@host:port/db</p>
<p>unix://[password]@/path/to/socket.sock?db=db</p>
<p>这三种url分别表示创建Redis TCP连接、Redis TCP+SSL连接、Redis UNIX socket连接，我们只需要构造其中一种即可，其中password部分如果没有可以省略，下面用URL连接演示下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">url = <span class="string">&#x27;redis://foobared@localhost:6379/0&#x27;</span></span><br><span class="line">pool = ConnectionPool.form_url(url)</span><br><span class="line">redis = StrictRedis(connection_pool=pool)</span><br></pre></td></tr></table></figure>

<h4 id="键操作"><a href="#键操作" class="headerlink" title="键操作"></a>键操作</h4><p>点击<a class="link"   target="_blank" rel="noopener" href="https://www.runoob.com/redis/redis-keys.html" >这里跳转<i class="fas fa-external-link-alt"></i></a>，可配合书第152页</p>
<h4 id="字符串操作"><a href="#字符串操作" class="headerlink" title="字符串操作"></a>字符串操作</h4><p>点击<a class="link"   target="_blank" rel="noopener" href="https://www.runoob.com/redis/redis-strings.html" >这里跳转<i class="fas fa-external-link-alt"></i></a>，可配合书第153页</p>
<h4 id="列表操作"><a href="#列表操作" class="headerlink" title="列表操作"></a>列表操作</h4><p>点击<a class="link"   target="_blank" rel="noopener" href="https://www.runoob.com/redis/redis-lists.html" >这里操作<i class="fas fa-external-link-alt"></i></a>，可配合书第154页</p>
<h4 id="集合操作"><a href="#集合操作" class="headerlink" title="集合操作"></a>集合操作</h4><p>点击<a class="link"   target="_blank" rel="noopener" href="https://www.runoob.com/redis/redis-sets.html" >这里跳转<i class="fas fa-external-link-alt"></i></a>，可配合书第155页</p>
<h4 id="有序集合操作"><a href="#有序集合操作" class="headerlink" title="有序集合操作"></a>有序集合操作</h4><p>点击<a class="link"   target="_blank" rel="noopener" href="https://www.runoob.com/redis/redis-sorted-sets.html" >这里跳转<i class="fas fa-external-link-alt"></i></a>，可配合书第157页</p>
<h4 id="散列操作"><a href="#散列操作" class="headerlink" title="散列操作"></a>散列操作</h4><p>点击<a class="link"   target="_blank" rel="noopener" href="https://www.runoob.com/redis/redis-hashes.html" >这里跳转<i class="fas fa-external-link-alt"></i></a>，可配合书第158页</p>
<h3 id="Elasticsearch搜索引擎存储"><a href="#Elasticsearch搜索引擎存储" class="headerlink" title="Elasticsearch搜索引擎存储"></a>Elasticsearch搜索引擎存储</h3>
        </div>

        
            <div class="post-copyright-info">
                .article-copyright-info-container {
  position: relative;
  width: 100%;
  box-sizing: border-box;
  padding: 10px 6px;
  font-size: 1rem;
  background: var(--second-background-color);

  &::after {
    position: absolute;
    top: 0;
    left: 0;
    content: '';
    width: 6px;
    height: 100%;
    background: var(--copyright-info-color);
  }


  ul {

    margin-left: 10px;

    li {
      margin-bottom: 5px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      color: var(--default-text-color);

      .license {
        font-weight: bold;
      }

      &:last-child {
        margin-bottom: 0;
      }
    }
  }
}

            </div>
        

        

        
            <div class="article-nav">
                
                    <div class="article-prev">
                        <a class="prev"
                           rel="prev"
                           href="/2022/02/08/Python3%E7%BD%91%E7%BB%9C%E7%88%AC%E8%99%AB%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98%E7%AC%AC%E4%BA%8C%E7%89%88%E7%AC%AC5%E7%AB%A0-Ajax%E6%95%B0%E6%8D%AE%E7%88%AC%E5%8F%96/"
                        >
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                            <span class="title flex-center">
                                <span class="post-nav-title-item">Python3网络爬虫开发实战第二版第5章-Ajax数据爬取</span>
                                <span class="post-nav-item">Prev posts</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next">
                        <a class="next"
                           rel="next"
                           href="/2022/02/08/Python3%E7%BD%91%E7%BB%9C%E7%88%AC%E8%99%AB%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98%E7%AC%AC%E4%BA%8C%E7%89%88%E7%AC%AC3%E7%AB%A0-%E7%BD%91%E9%A1%B5%E6%95%B0%E6%8D%AE%E7%9A%84%E8%A7%A3%E6%9E%90%E6%8F%90%E5%8F%96/"
                        >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">Python3网络爬虫开发实战第二版第3章-网页数据的解析提取</span>
                                <span class="post-nav-item">Next posts</span>
                            </span>
                            <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        

        
            <div class="comment-container">
                <div class="comments-container">
    <div id="comment-anchor"></div>
    <div class="comment-area-title">
        <i class="fas fa-comments">&nbsp;Comments</i>
    </div>
    

        
            
    <div class="valine-container">
        <script data-pjax
                src="//cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"></script>
        <div id="vcomments"></div>
        <script data-pjax>
            function loadValine() {
                new Valine({
                    el: '#vcomments',
                    appId: 'nIcO1O6cSVuRH8EROCWwNFWN-gzGzoHsz',
                    appKey: 'qrglokTeum8DXiYRzM4k4NF4',
                    meta: ['nick', 'mail', 'link'],
                    avatar: 'wavatar',
                    enableQQ: true,
                    placeholder: '😜 尽情吐槽吧~',
                    lang: 'en'.toLowerCase()
                });

                function getAuthor(language) {
                    switch (language) {
                        case 'en':
                            return 'Author';
                        case 'zh-CN':
                            return '博主';
                        default:
                            return 'Master';
                    }
                }

                // Add "Author" identify
                const getValineDomTimer = setInterval(() => {
                    const vcards = document.querySelectorAll('#vcomments .vcards .vcard');
                    if (vcards.length > 0) {
                        let author = 'Lhj';

                        if (author) {
                            for (let vcard of vcards) {
                                const vnick_dom = vcard.querySelector('.vhead .vnick');
                                const vnick = vnick_dom.innerHTML;
                                if (vnick === author) {
                                    vnick_dom.innerHTML = `${vnick} <span class="author">${getAuthor(KEEP.hexo_config.language)}</span>`
                                }
                            }
                        }
                        clearInterval(getValineDomTimer);
                    } else {
                        clearInterval(getValineDomTimer);
                    }
                }, 2000);
            }

            if ('true') {
                const loadValineTimeout = setTimeout(() => {
                    loadValine();
                    clearTimeout(loadValineTimeout);
                }, 1000);
            } else {
                window.addEventListener('DOMContentLoaded', loadValine);
            }
        </script>
    </div>



        
    
</div>

            </div>
        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
              <span>2020</span>
              -
            
            2022&nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;<a href="/">Lhj</a>
        </div>
        
            <script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    <span id="busuanzi_container_site_uv">
                        Visitor Count&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp;
                    </span>
                
                
                    <span id="busuanzi_container_site_pv">
                        Totalview&nbsp;<span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="theme-info info-item">
            Powered by <a target="_blank" href="https://hexo.io">Hexo</a>&nbsp;|&nbsp;Theme&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.4.5</a>
        </div>
        
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item page-aside-toggle">
                <i class="fas fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
            <li class="go-comment">
                <i class="fas fa-comment"></i>
            </li>
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-expand-width flex-center">
            <i class="fas fa-arrows-alt-h"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        
            <li class="tools-item rss flex-center">
                <a class="flex-center"
                   href="/atom.xml"
                   target="_blank"
                >
                    <i class="fas fa-rss"></i>
                </a>
            </li>
        

        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
    </ul>
</div>

    </div>

    
        <aside class="page-aside">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#TXT%E6%96%87%E6%9C%AC%E6%96%87%E4%BB%B6%E5%AD%98%E5%82%A8"><span class="nav-number">1.</span> <span class="nav-text">TXT文本文件存储</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#JSON%E6%96%87%E4%BB%B6%E5%AD%98%E5%82%A8"><span class="nav-number">2.</span> <span class="nav-text">JSON文件存储</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CSV%E6%96%87%E4%BB%B6%E5%AD%98%E5%82%A8"><span class="nav-number">3.</span> <span class="nav-text">CSV文件存储</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MySQL%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8"><span class="nav-number">4.</span> <span class="nav-text">MySQL数据存储</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MongoDB%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8"><span class="nav-number">5.</span> <span class="nav-text">MongoDB数据存储</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%89%E8%A3%85MongoDB"><span class="nav-number">5.1.</span> <span class="nav-text">安装MongoDB</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%9E%E6%8E%A5MongoDB"><span class="nav-number">5.2.</span> <span class="nav-text">连接MongoDB</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">5.3.</span> <span class="nav-text">创建数据库</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E9%9B%86%E5%90%88"><span class="nav-number">5.4.</span> <span class="nav-text">创建集合</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8C%87%E5%AE%9A%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">5.5.</span> <span class="nav-text">指定数据库</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8C%87%E5%AE%9A%E9%9B%86%E5%90%88"><span class="nav-number">5.6.</span> <span class="nav-text">指定集合</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8F%92%E5%85%A5%E6%95%B0%E6%8D%AE"><span class="nav-number">5.7.</span> <span class="nav-text">插入数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9F%A5%E8%AF%A2"><span class="nav-number">5.8.</span> <span class="nav-text">查询</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AE%A1%E6%95%B0"><span class="nav-number">5.9.</span> <span class="nav-text">计数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8E%92%E5%BA%8F"><span class="nav-number">5.10.</span> <span class="nav-text">排序</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%81%8F%E7%A7%BB"><span class="nav-number">5.11.</span> <span class="nav-text">偏移</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9B%B4%E6%96%B0"><span class="nav-number">5.12.</span> <span class="nav-text">更新</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%A0%E9%99%A4"><span class="nav-number">5.13.</span> <span class="nav-text">删除</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%B6%E5%AE%83%E6%93%8D%E4%BD%9C"><span class="nav-number">5.14.</span> <span class="nav-text">其它操作</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Redi%E7%BC%93%E5%AD%98%E5%AD%98%E5%82%A8"><span class="nav-number">6.</span> <span class="nav-text">Redi缓存存储</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%89%E8%A3%85Redis"><span class="nav-number">6.1.</span> <span class="nav-text">安装Redis</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Redis%E5%92%8CStrictRedis"><span class="nav-number">6.1.1.</span> <span class="nav-text">Redis和StrictRedis</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%9E%E6%8E%A5Redis"><span class="nav-number">6.2.</span> <span class="nav-text">连接Redis</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%94%AE%E6%93%8D%E4%BD%9C"><span class="nav-number">6.3.</span> <span class="nav-text">键操作</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%93%8D%E4%BD%9C"><span class="nav-number">6.4.</span> <span class="nav-text">字符串操作</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%97%E8%A1%A8%E6%93%8D%E4%BD%9C"><span class="nav-number">6.5.</span> <span class="nav-text">列表操作</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9B%86%E5%90%88%E6%93%8D%E4%BD%9C"><span class="nav-number">6.6.</span> <span class="nav-text">集合操作</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%89%E5%BA%8F%E9%9B%86%E5%90%88%E6%93%8D%E4%BD%9C"><span class="nav-number">6.7.</span> <span class="nav-text">有序集合操作</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%A3%E5%88%97%E6%93%8D%E4%BD%9C"><span class="nav-number">6.8.</span> <span class="nav-text">散列操作</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Elasticsearch%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E%E5%AD%98%E5%82%A8"><span class="nav-number">7.</span> <span class="nav-text">Elasticsearch搜索引擎存储</span></a></li></ol>
    </div>
</div>
        </aside>
    

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="Search..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>



<script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/utils.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/main.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/header-shrink.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/back2top.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/dark-light-toggle.js"></script>


    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/local-search.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/code-copy.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/lazyload.js"></script>


<div class="post-scripts pjax">
    
        <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/left-side-toggle.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/libs/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/toc.js"></script>
    
</div>


    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/libs/pjax.min.js"></script>
<script>
    window.addEventListener('DOMContentLoaded', () => {
        window.pjax = new Pjax({
            selectors: [
                'head title',
                '.page-container',
                '.pjax'
            ],
            history: true,
            debug: false,
            cacheBust: false,
            timeout: 0,
            analytics: false,
            currentUrlFullReload: false,
            scrollRestoration: false,
            // scrollTo: true,
        });

        document.addEventListener('pjax:send', () => {
            KEEP.utils.pjaxProgressBarStart();
        });

        document.addEventListener('pjax:complete', () => {
            KEEP.utils.pjaxProgressBarEnd();
            window.pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
            KEEP.refresh();
        });
    });
</script>



</body>
</html>
